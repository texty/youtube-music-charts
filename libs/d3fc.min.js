(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3-array"),require("d3-scale"),require("d3-time"),require("d3-random"),require("d3-fetch"),require("d3-path"),require("d3-selection"),require("d3-shape"),require("d3-dispatch"),require("d3-brush")):"function"==typeof define&&define.amd?define(["exports","d3-array","d3-scale","d3-time","d3-random","d3-fetch","d3-path","d3-selection","d3-shape","d3-dispatch","d3-brush"],t):(e=e||self,t(e.fc={},e.d3,e.d3,e.d3,e.d3,e.d3,e.d3,e.d3,e.d3,e.d3,e.d3))})(this,function(e,t,a,n,i,l,r,o,s,d,c){'use strict';var B=Math.round,R=Math.floor,M=Math.min,Q=Math.ceil,F=Math.exp,U=Math.max,G=Math.abs;function h(e){return e}function g(){}function m(e){return"function"==typeof e?e:()=>e}function u(e){return"number"==typeof e&&isNaN(e)?void 0:e}function p(){let e=()=>10,t=g,a=h,n=e=>null!=e;var i=function(i){const l=e.apply(this,arguments),r=i.slice(0,l).map(a);return i.map((e,o)=>(o>=l&&(r.shift(),r.push(a(e,o))),o<l-1||r.some(e=>!n(e))?t(void 0,o):t(r,o)))};return i.period=(...t)=>t.length?(e=m(t[0]),i):e,i.accumulator=(...e)=>e.length?(t=e[0],i):t,i.defined=(...e)=>e.length?(n=e[0],i):n,i.value=(...e)=>e.length?(a=e[0],i):a,i}function f(){let e=2;const a=p().accumulator(a=>{const n=a&&t.deviation(a),i=a&&t.mean(a);return{average:i,upper:u(i+e*n),lower:u(i-e*n)}}),n=e=>a(e);return n.multiplier=(...t)=>t.length?(e=t[0],n):e,q(n,a,"period","value"),n}function y(){let e=h,a=()=>9;const n=e=>{let a=[];return n=>{let i;return a.length<e&&(null==n?a=[]:a.push(n)),a.length>=e&&(i=t.mean(a)),i}},i=function(t){const i=a.apply(this,arguments),l=2/(i+1),r=n(i);let o;return t.map((t,a)=>{const n=e(t,a);return o=void 0===o?r(n):n*l+(1-l)*o,u(o)})};return i.period=(...e)=>e.length?(a=m(e[0]),i):a,i.value=(...t)=>t.length?(e=t[0],i):e,i}function x(){let e=h;const a=y().period(12),n=y().period(26),i=y().period(9),l=l=>{a.value(e),n.value(e);const r=t.zip(a(l),n(l)).map(e=>void 0!==e[0]&&void 0!==e[1]?e[0]-e[1]:void 0),o=i(r);return t.zip(r,o).map(e=>({macd:e[0],signal:e[1],divergence:void 0!==e[0]&&void 0!==e[1]?e[0]-e[1]:void 0}))};return l.value=(...t)=>t.length?(e=t[0],l):e,H(l,a,K({period:"fastPeriod"})),H(l,n,K({period:"slowPeriod"})),H(l,i,K({period:"signalPeriod"})),l}function v(){const e=p().accumulator(e=>e&&t.mean(e)),a=t=>e(t);return q(a,e,"period","value"),a}function w(){let e=.1,t=h;const a=a=>a.map(a=>{const n=u(t(a)*(1-e)),i=u(t(a)*(1+e));return{lower:n,upper:i}});return a.factor=(...t)=>t.length?(e=t[0],a):e,a.value=(...e)=>e.length?(t=e[0],a):t,a}function b(){let e=e=>e.close,a=e=>e.high,n=e=>e.low;const i=y().period(13),l=l=>(i.value(e),t.zip(l,i(l)).map(e=>{const t=u(a(e[0])-e[1]),i=u(n(e[0])-e[1]);return{bullPower:t,bearPower:i}}));return l.closeValue=(...t)=>t.length?(e=t[0],l):e,l.highValue=(...e)=>e.length?(a=e[0],l):a,l.lowValue=(...e)=>e.length?(n=e[0],l):n,q(l,i,"period"),l}function S(){var e={};return e.distance=function(e,t){return t-e},e.offset=function(e,t){return e instanceof Date?new Date(e.getTime()+t):e+t},e.clampUp=e=>e,e.clampDown=e=>e,e.copy=()=>e,e}function k(e,t){const a=[];for(const n of e){const e=t.clampUp(n),i=t.clampDown(n);e===i&&a.push(e)}return a}function _(e){arguments.length||(e=a.scaleIdentity());var t=S();const n=a=>{var n=e.domain(),i=e.range(),l=t.distance(n[0],n[1]),r=t.distance(n[0],a),o=r/l*(i[1]-i[0])+i[0];return o};return n.invert=a=>{var n=e.domain(),i=e.range(),l=(a-i[0])/(i[1]-i[0]),r=t.distance(n[0],n[1]);return t.offset(n[0],l*r)},n.domain=(...a)=>{if(!a.length)return e.domain();const i=a[0];var l=t.clampUp(i[0]),r=t.clampDown(i[1]);return e.domain([l,r]),n},n.nice=()=>{e.nice();var a=e.domain(),i=t.clampUp(a[0]),l=t.clampDown(a[1]);return e.domain([i,l]),n},n.ticks=(...a)=>{var n=e.ticks.apply(this,a);return k(n,t)},n.copy=()=>_(e.copy()).discontinuityProvider(t.copy()),n.discontinuityProvider=(...e)=>e.length?(t=e[0],n):t,H(n,e,X("range","rangeRound","interpolate","clamp","tickFormat")),n}function T(){let e=[e=>e],a=[0,0],n="percent",i=null,l=[];const r=r=>{const o=Array(r.length);for(const t of e)for(let e=0;e<r.length;e++){const a=t(r[e],e);Array.isArray(a)?o.push(...a):o.push(a)}const s=[t.min(o),t.max(o)];if(s[0]=null==s[0]?t.min(l):t.min([s[0],...l]),s[1]=null==s[1]?t.max(l):t.max([s[1],...l]),null!=i){const e=U(G(s[1]-i),G(s[0]-i));s[0]=i-e,s[1]=i+e}switch(n){case"domain":{s[0]-=a[0],s[1]+=a[1];break}case"percent":{const e=s[1]-s[0];s[0]-=a[0]*e,s[1]+=a[1]*e;break}default:throw new Error(`Unknown padUnit: ${n}`);}return s};return r.accessors=(...t)=>t.length?(e=t[0],r):e,r.pad=(...e)=>e.length?(a=e[0],r):a,r.padUnit=(...e)=>e.length?(n=e[0],r):n,r.include=(...e)=>e.length?(l=e[0],r):l,r.symmetricalAbout=(...e)=>e.length?(i=e[0],r):i,r}function A(){let e=[],t=[0,0],a="percent",n=null,i=[];const l=T(),r=e=>null==e?null:e.valueOf(),o=o=>{const s=e.map(e=>(...t)=>{const a=e(...t);return Array.isArray(a)?a.map(r):r(a)});return l.accessors(s).pad(t).padUnit(a).symmetricalAbout(null==n?null:n.valueOf()).include(i.map(e=>e.valueOf())),l(o).map(e=>new Date(e))};return o.accessors=(...t)=>t.length?(e=t[0],o):e,o.pad=(...e)=>e.length?(t=e[0],o):t,o.padUnit=(...e)=>e.length?(a=e[0],o):a,o.include=(...e)=>e.length?(i=e[0],o):i,o.symmetricalAbout=(...e)=>e.length?(n=e[0],o):n,o}function z(){let e=1,t=20,a=.1,n=.1,l=i.randomNormal();var r=(i=0)=>{var r=Math.sqrt;const o=e/t,s=[];for(let e=0;e<t+1;e++){s.push(i);const e=l()*r(o)*n+(a-n*n/2)*o;i*=F(e)}return s};return r.period=(...t)=>t.length?(e=t[0],r):e,r.steps=(...e)=>e.length?(t=e[0],r):t,r.mu=(...e)=>e.length?(a=e[0],r):a,r.sigma=(...e)=>e.length?(n=e[0],r):n,r.random=(...e)=>e.length?(l=e[0],r):l,r}function V(e){return"function"==typeof e?e:()=>e}function I(){let e=new Date,t=100,a=n.timeDay,l=1,r=n.timeYear,o=1,s=null,d=()=>{const e=i.randomNormal(1,.1);return Q(1e3*e())};const c=z(),h=e=>{const t=r.offset(e,o)-e;return(a.offset(e,l)-e)/t},g=(e,t)=>{const a=h(e),n=c.period(a)(t),i={date:e,open:n[0],high:U.apply(Math,n),low:M.apply(Math,n),close:n[c.steps()]};return i.volume=d(i),i},m=n=>{let i,r,o;do i=n?a.offset(n.date,l):new Date(e.getTime()),r=n?n.close:t,n=g(i,r),o=s&&!s(n);while(o);return n},u=()=>{let e;const t={};return t.next=()=>{const t=m(e);return e=t,t},t.take=e=>t.until((t,a)=>!e||0>e||a===e),t.until=t=>{const a=[];let n=0,i=m(e),l=t&&!t(i,n);for(;l;)a.push(i),e=i,i=m(e),n+=1,l=t&&!t(i,n);return a},t},p=e=>u().take(e);if(p.stream=u,"function"!=typeof Symbol||"symbol"!=typeof Symbol.iterator)throw new Error("d3fc-random-data depends on Symbol. Make sure that you load a polyfill in older browsers. See README.");return p[Symbol.iterator]=()=>{const e=u();return{next:()=>({value:e.next(),done:!1})}},p.startDate=(...t)=>t.length?(e=t[0],p):e,p.startPrice=(...e)=>e.length?(t=e[0],p):t,p.interval=(...e)=>e.length?(a=e[0],p):a,p.intervalStep=(...e)=>e.length?(l=e[0],p):l,p.unitInterval=(...e)=>e.length?(r=e[0],p):r,p.unitIntervalStep=(...e)=>e.length?(o=e[0],p):o,p.filter=(...e)=>e.length?(s=e[0],p):s,p.volume=(...e)=>e.length?(d=V(e[0]),p):d,H(p,c),p}function P(){var e="BTC-USD",t=null,a=null,n=null,i=function(){var i=[];null!=t&&i.push("start="+t.toISOString()),null!=a&&i.push("end="+a.toISOString()),null!=n&&i.push("granularity="+n);var r="https://api.gdax.com/products/"+e+"/candles?"+i.join("&");return l.json(r).then(function(e){return e.map(function(e){return{date:new Date(1e3*e[0]),open:e[3],high:e[2],low:e[1],close:e[4],volume:e[5]}})})};return i.product=function(t){return arguments.length?(e=t,i):e},i.start=function(e){return arguments.length?(t=e,i):t},i.end=function(e){return arguments.length?(a=e,i):a},i.granularity=function(e){return arguments.length?(n=e,i):n},i}function E(){var e=10,a=a=>1>=e?a.map(e=>[e]):t.range(0,Q(a.length/e)).map(t=>a.slice(t*e,(t+1)*e));return a.bucketSize=function(t){return arguments.length?(e=t,a):e},a}function D(){function e(e){var a=e.map(e=>[n(e),i(e)]),l=t.range(1,a.length-1).map(e=>{var t=a[e-1],n=a[e],i=a[e+1];return .5*G((t[0]-i[0])*(n[1]-t[1])-(t[0]-n[0])*(i[1]-t[1]))});return l}var a=E(),n=e=>e,i=e=>e;const l=n=>{if(a.bucketSize()>=n.length)return n;var i=e(n),l=a(i),r=a(n.slice(1,n.length-1)),o=r.map((e,a)=>{var n=l[a],i=t.max(n),r=n.indexOf(i);return e[r]});return[].concat([n[0]],o,[n[n.length-1]])};return q(l,a,"bucketSize"),l.x=function(e){return arguments.length?(n=e,l):n},l.y=function(e){return arguments.length?(i=e,l):i},l}function C(){var e=e=>e,a=e=>e,n=E();const i=i=>{if(n.bucketSize()>=i.length)return i;var l=n(i.slice(1,i.length-1)),r=i[0],o=i[i.length-1],s=[].concat([r],l,[o]),d=e(r),c=a(r),h=l.map((n,l)=>{var i=t.mean(s[l+1],e),r=t.mean(s[l+1],a),o=n.map(t=>[e(t),a(t)]),h=o.map(e=>.5*G((d-i)*(e[1]-c)-(d-e[0])*(r-c))),g=h.indexOf(t.max(h)),m=o[g];return d=m[0],c=m[1],n[g]});return[].concat([i[0]],h,[i[i.length-1]])};return q(i,n,"bucketSize"),i.x=function(t){return arguments.length?(e=t,i):e},i.y=function(e){return arguments.length?(a=e,i):a},i}function L(){var e=E(),a=e=>e;const n=n=>{if(e.bucketSize()>n.length)return n;var i=t.extent(n,a),l=e(n.slice(1,n.length-1)),r=l.map(e=>{var t,n,l={},r=!0,o=e.map(a),s=o.filter(e=>e===i[0]||e===i[1]).map(e=>o.indexOf(e))[0];return void 0===s?(o.forEach((e,a)=>{void 0===l[e]&&(l[e]=0),l[e]++,l[e]>l[t]||void 0===t?(t=e,n=a,r=!0):l[e]===l[t]&&(r=!1)}),r?e[n]:e[R(e.length/2)]):e[s]});return[].concat([n[0]],r,[n[n.length-1]])};return q(n,e,"bucketSize"),n.value=function(e){return arguments.length?(a=e,n):a},n}function O(){const e=arguments;return function(t,a){for(let n=0,i=e.length;n<i;n++)if(null==e[n](t,a))return!1;return!0}}var j=(e,t,a)=>{const n=t[a];if("function"!=typeof n)throw new Error(`Attempt to rebind ${a} which isn't a function on the source object`);return(...a)=>{var i=n.apply(t,a);return i===t?e:i}},q=(e,t,...a)=>{for(const n of a)e[n]=j(e,t,n);return e};const N=e=>t=>e.reduce((e,t)=>e&&t(e),t);var H=(e,t,...a)=>{const n=N(a);for(const i of Object.keys(t)){const a=n(i);a&&(e[a]=j(e,t,i))}return e},W=e=>e.map(e=>"string"==typeof e?new RegExp(`^${e}$`):e),Y=(...e)=>(e=W(e),t=>e.every(e=>!e.test(t))&&t),X=(...e)=>(e=W(e),t=>e.some(e=>e.test(t))&&t),K=e=>t=>e[t];const J=e=>e[0].toUpperCase()+e.slice(1);var Z=e=>t=>e+J(t);const $=(e,t,a,n)=>{const i={sunday:0,monday:1,saturday:6},l=86400000,r=5*l,o={},s=t=>0===e(t)||6===e(t);return o.clampDown=a=>{if(a&&s(a)){const n=t.ceil(a);return e(n)===i.sunday?t.offset(n,-1):e(n)===i.monday?t.offset(n,-2):n}return a},o.clampUp=a=>{if(a&&s(a)){const n=t.floor(a);return e(n)===i.saturday?t.offset(n,2):e(n)===i.sunday?t.offset(n,1):n}return a},o.distance=function(e,t){e=o.clampUp(e),t=o.clampDown(t);const n=a.ceil(e);if(t<n)return t.getTime()-e.getTime();const i=n.getTime()-e.getTime(),s=a.ceil(t),d=s.getTime()-t.getTime(),c=B((s.getTime()-n.getTime())/(7*l));return c*r+i-d},o.offset=function(e,i){let l=s(e)?o.clampUp(e):e;if(0===i)return l;const d=0>i;let c=i;const h=d?n.floor(l):a.ceil(l);if(c-=h.getTime()-l.getTime(),d&&0<c||0<i&&0>c)return new Date(l.getTime()+i);l=d?h:t.offset(h,2);const g=R(c/r);return l=t.offset(l,7*g),c-=g*r,l=new Date(l.getTime()+c),l},o.copy=function(){return o},o};var ee=e=>"function"==typeof e?e:()=>e,te=()=>{let e=null,t=e=>e.date,a=e=>e.open,n=e=>e.high,l=e=>e.low,o=e=>e.close,s="vertical",c=ee(3);const h=function(i){const h=e||r.path();return i.forEach(function(e,r){const i=t(e,r),d=a(e,r),g=n(e,r),m=l(e,r),u=o(e,r),p=c(e,r)/2;"vertical"===s?(h.moveTo(i,m),h.lineTo(i,g),h.moveTo(i,d),h.lineTo(i-p,d),h.moveTo(i,u),h.lineTo(i+p,u)):(h.moveTo(m,i),h.lineTo(g,i),h.moveTo(d,i),h.lineTo(d,i+p),h.moveTo(u,i),h.lineTo(u,i-p))}),e?null:h.toString()};return h.context=(...t)=>t.length?(e=t[0],h):e,h.x=(...e)=>e.length?(t=ee(e[0]),h):t,h.open=(...e)=>e.length?(a=ee(e[0]),h):a,h.high=(...e)=>e.length?(n=ee(e[0]),h):n,h.low=(...e)=>e.length?(l=ee(e[0]),h):l,h.close=(...e)=>e.length?(o=ee(e[0]),h):o,h.width=(...e)=>e.length?(c=ee(e[0]),h):c,h.orient=(...e)=>e.length?(s=e[0],h):s,h},ae=()=>{let e=null,t=e=>e.x,a=e=>e.y,n="center",i="center",l=e=>e.height,o=ee(3);const s=function(s,c){const h=e||r.path();return s.forEach(function(e,r){const s=t.call(this,e,c||r),d=a.call(this,e,c||r),g=l.call(this,e,c||r),m=o.call(this,e,c||r);let u;switch(n){case"left":u=m;break;case"right":u=0;break;case"center":u=m/2;break;default:throw new Error("Invalid horizontal alignment "+n);}let p;switch(i){case"bottom":p=-g;break;case"top":p=0;break;case"center":p=g/2;break;default:throw new Error("Invalid vertical alignment "+i);}h.rect(s-u,d-p,m,g)},this),e?null:h.toString()};return s.context=(...t)=>t.length?(e=t[0],s):e,s.x=(...e)=>e.length?(t=ee(e[0]),s):t,s.y=(...e)=>e.length?(a=ee(e[0]),s):a,s.width=(...e)=>e.length?(o=ee(e[0]),s):o,s.horizontalAlign=(...e)=>e.length?(n=e[0],s):n,s.height=(...e)=>e.length?(l=ee(e[0]),s):l,s.verticalAlign=(...e)=>e.length?(i=e[0],s):i,s},ne=()=>{let e=null,t=e=>e.date,a=e=>e.open,n=e=>e.high,l=e=>e.low,o=e=>e.close,s=ee(3);const d=function(i){const c=e||r.path();return i.forEach(function(e,r){const i=t(e,r),d=a(e,r),h=n(e,r),g=l(e,r),m=o(e,r),u=s(e,r);c.rect(i-u/2,d,u,m-d),c.moveTo(i,M(m,d)),c.lineTo(i,h),c.moveTo(i,U(m,d)),c.lineTo(i,g)}),e?null:c.toString()};return d.context=(...t)=>t.length?(e=t[0],d):e,d.x=(...e)=>e.length?(t=ee(e[0]),d):t,d.open=(...e)=>e.length?(a=ee(e[0]),d):a,d.high=(...e)=>e.length?(n=ee(e[0]),d):n,d.low=(...e)=>e.length?(l=ee(e[0]),d):l,d.close=(...e)=>e.length?(o=ee(e[0]),d):o,d.width=(...e)=>e.length?(s=ee(e[0]),d):s,d},ie=()=>{let e=null,t=e=>e.value,a=e=>e.median,n=e=>e.upperQuartile,l=e=>e.lowerQuartile,o=e=>e.high,s=e=>e.low,c="vertical",h=ee(5),g=ee(.5);const m=function(i){const m=e||r.path();return i.forEach(function(e,r){const i=t(e,r),d=h(e,r),u=d/2,p=d*g(e,r),f=p/2,y=o(e,r),x=n(e,r),v=a(e,r),w=l(e,r),b=s(e,r),S=w-x;"vertical"===c?(m.moveTo(i-f,y),m.lineTo(i+f,y),m.moveTo(i,y),m.lineTo(i,x),m.rect(i-u,x,d,S),m.moveTo(i-u,v),m.lineTo(i+u,v),m.moveTo(i,w),m.lineTo(i,b),m.moveTo(i-f,b),m.lineTo(i+f,b)):(m.moveTo(b,i-f),m.lineTo(b,i+f),m.moveTo(b,i),m.lineTo(w,i),m.rect(w,i-u,-S,d),m.moveTo(v,i-u),m.lineTo(v,i+u),m.moveTo(x,i),m.lineTo(y,i),m.moveTo(y,i-f),m.lineTo(y,i+f))}),e?null:m.toString()};return m.context=(...t)=>t.length?(e=t[0],m):e,m.value=(...e)=>e.length?(t=ee(e[0]),m):t,m.median=(...e)=>e.length?(a=ee(e[0]),m):a,m.upperQuartile=(...e)=>e.length?(n=ee(e[0]),m):n,m.lowerQuartile=(...e)=>e.length?(l=ee(e[0]),m):l,m.high=(...e)=>e.length?(o=ee(e[0]),m):o,m.low=(...e)=>e.length?(s=ee(e[0]),m):s,m.width=(...e)=>e.length?(h=ee(e[0]),m):h,m.orient=(...e)=>e.length?(c=e[0],m):c,m.cap=(...e)=>e.length?(g=ee(e[0]),m):g,m},le=()=>{let e=null,t=e=>e.x,a=e=>e.high,n=e=>e.low,l="vertical",o=ee(5);const s=function(i){const s=e||r.path();return i.forEach(function(e,r){const i=t(e,r),d=o(e,r),c=d/2,h=a(e,r),g=n(e,r);"vertical"===l?(s.moveTo(i-c,h),s.lineTo(i+c,h),s.moveTo(i,h),s.lineTo(i,g),s.moveTo(i-c,g),s.lineTo(i+c,g)):(s.moveTo(g,i-c),s.lineTo(g,i+c),s.moveTo(g,i),s.lineTo(h,i),s.moveTo(h,i-c),s.lineTo(h,i+c))}),e?null:s.toString()};return s.context=(...t)=>t.length?(e=t[0],s):e,s.value=(...e)=>e.length?(t=ee(e[0]),s):t,s.high=(...e)=>e.length?(a=ee(e[0]),s):a,s.low=(...e)=>e.length?(n=ee(e[0]),s):n,s.width=(...e)=>e.length?(o=ee(e[0]),s):o,s.orient=(...e)=>e.length?(l=e[0],s):l,s},re=e=>"function"==typeof e?e:()=>e;const oe=1e-6;var se=(e,t)=>{e=e||"g";let a=(e,t)=>t,n=null;const i=function(i,l){l=l||(e=>e);const r=i.selection?i:null;r&&(i=i.selection());const o=i.selectAll((e,t,a)=>Array.from(a[t].childNodes).filter(e=>1===e.nodeType)).filter(null==t?e:`${e}.${t}`);let s=o.data(l,a);const d=s.enter().append(e).attr("class",t);let c=s.exit();s=s.merge(d);const h=r||n;return h&&(s=s.transition(h).style("opacity",1),d.style("opacity",oe),c=c.transition(h).style("opacity",oe)),c.remove(),s.enter=()=>d,s.exit=()=>c,s};return i.element=(...t)=>t.length?(e=t[0],i):e,i.className=(...e)=>e.length?(t=e[0],i):t,i.key=(...e)=>e.length?(a=e[0],i):a,i.transition=(...e)=>e.length?(n=e[0],i):n,i};const de=(e,t)=>!(e.x>=t.x+t.width||e.x+e.width<=t.x||e.y>=t.y+t.height||e.y+e.height<=t.y);var ce=(e,t)=>{if(de(e,t)){const a=U(e.x,t.x),n=M(e.x+e.width,t.x+t.width),i=U(e.y,t.y),l=M(e.y+e.height,t.y+t.height);return(n-a)*(l-i)}return 0};const he=(e,a)=>t.sum(e.map((t,n)=>a===n?0:ce(e[a],t))),ge=(e,t,a,n,i)=>({x:e,y:t,width:a,height:n,location:i});var me=e=>{const t=e.x,a=e.y,n=e.width,i=e.height;return[ge(t,a,n,i,"bottom-right"),ge(t-n,a,n,i,"bottom-left"),ge(t-n,a-i,n,i,"top-left"),ge(t,a-i,n,i,"top-right"),ge(t,a-i/2,n,i,"middle-right"),ge(t-n/2,a,n,i,"bottom-center"),ge(t-n,a-i/2,n,i,"middle-left"),ge(t-n/2,a-i,n,i,"top-center")]};const ue=(e,t,a)=>[...e.slice(0,t),a,...e.slice(t+1)],pe=(e,t)=>e<t,fe=()=>{let e,a=null,n=pe,l=()=>0;const r=(t,n)=>a-l(e[n],n,e)+l(t,n,ue(e,n,t)),o=(i,s)=>{a||(a=t.sum(e.map((t,a)=>l(t,a,e))));const d=r(i,s);return n(d,a)?fe().locationScore(l).winningScore(n).score(d).rectangles(ue(e,s,i)):o};return o.rectangles=(...t)=>t.length?(e=t[0],o):e,o.score=(...e)=>e.length?(a=e[0],o):a,o.winningScore=(...e)=>e.length?(n=e[0],o):n,o.locationScore=(...e)=>e.length?(l=e[0],o):l,o};const ye=e=>e[xe(e)],xe=e=>R(Math.random()*e.length);const ve=(e,a)=>e[t.scan(e,a)];var we=e=>"function"==typeof e?e:()=>e,be=(e,t)=>"left"===e?t/2:"right"===e?-t/2:0,Se=e=>{const t=Object.assign({},e),a=()=>{};return Object.keys(t).forEach(e=>{a[e]=(...n)=>n.length?(t[e]=n[0],a):t[e]}),a},ke=()=>{let e=()=>0,t=e=>e.x,n=e=>e.y,l="center",r=()=>5,o="vertical";const s=Se({decorate:()=>{},defined:(a,l)=>O(e,t,n)(a,l),xScale:a.scaleIdentity(),yScale:a.scaleIdentity()});return s.values=(a,d)=>{const i=r(a,d),c=be(l,i),h=s.xScale(),g=s.yScale();if("vertical"===o){const l=g(n(a,d),d),r=g(e(a,d),d),o=h(t(a,d),d)+c;return{d:a,x:o,y:l,y0:r,width:i,height:l-r,origin:[o,l],baseOrigin:[o,r],transposedX:o,transposedY:l}}else{const l=h(n(a,d),d),r=h(e(a,d),d),o=g(t(a,d),d)+c;return{d:a,x:o,y:l,y0:r,width:i,height:l-r,origin:[l,o],baseOrigin:[r,o],transposedX:l,transposedY:o}}},s.xValues=()=>"vertical"===o?[t]:[e,n],s.yValues=()=>"vertical"===o?[e,n]:[t],s.baseValue=(...t)=>t.length?(e=we(t[0]),s):e,s.crossValue=(...e)=>e.length?(t=we(e[0]),s):t,s.mainValue=(...e)=>e.length?(n=we(e[0]),s):n,s.bandwidth=(...e)=>e.length?(r=we(e[0]),s):r,s.align=(...e)=>e.length?(l=e[0],s):l,s.orient=(...e)=>e.length?(o=e[0],s):o,s};var _e={red:"#c60",green:"#6c0",black:"#000",gray:"#ddd",darkGray:"#999"},Te=()=>{const e=ke(),t=s.line().x((t,a)=>e.values(t,a).transposedX).y((t,a)=>e.values(t,a).transposedY),a=se("path","line"),n=n=>{n.selection&&a.transition(n),t.defined(e.defined()),n.each((n,i,l)=>{const r=a(o.select(l[i]),[n]);r.enter().attr("fill","none").attr("stroke",_e.black),r.attr("d",t),e.decorate()(r,n,i)})};return H(n,e,Y("baseValue","bandwidth","align")),q(n,a,"key"),q(n,t,"curve"),n},Ae=()=>{const e=ke(),t=s.line().x((t,a)=>e.values(t,a).transposedX).y((t,a)=>e.values(t,a).transposedY),a=a=>{const n=t.context();n.beginPath(),t.defined(e.defined())(a),n.strokeStyle=_e.black,n.fillStyle="transparent",e.decorate()(n,a),n.fill(),n.stroke(),n.closePath()};return H(a,e,Y("baseValue","bandwidth","align")),q(a,t,"curve","context"),a},ze=()=>{const e=s.symbol(),t=ke(),a=se("g","point"),n=e=>"translate("+e[0]+", "+e[1]+")",i=i=>{i.selection&&a.transition(i),i.each((i,l,r)=>{const s=i.filter(t.defined()),d=a(o.select(r[l]),s);d.enter().attr("transform",(e,a)=>n(t.values(e,a).origin)).attr("fill",_e.gray).attr("stroke",_e.black).append("path"),d.attr("transform",(e,a)=>n(t.values(e,a).origin)).select("path").attr("d",e),t.decorate()(d,i,l)})};return H(i,t,Y("baseValue","bandwidth","align")),q(i,a,"key"),q(i,e,"type","size"),i},Ve=()=>{const e=s.symbol(),t=ke(),a=a=>{const n=a.filter(t.defined()),l=e.context();n.forEach((a,n)=>{l.save();const i=t.values(a,n);l.translate(i.origin[0],i.origin[1]),l.beginPath(),e(a,n),l.strokeStyle=_e.black,l.fillStyle=_e.gray,t.decorate()(l,a,n),l.fill(),l.stroke(),l.closePath(),l.restore()})};return H(a,t,Y("baseValue","bandwidth","align")),q(a,e,"size","type","context"),a},Ie=()=>{let e=e=>e.high,t=e=>e.low,n=e=>e.cross,l="vertical",r="center",o=()=>5;const s=Se({decorate:()=>{},defined:(a,l)=>O(t,e,n)(a,l),xScale:a.scaleIdentity(),yScale:a.scaleIdentity()});return s.values=(a,d)=>{const i=o(a,d),c=be(r,i),h=s.xScale(),g=s.yScale();if("vertical"===l){const l=g(e(a,d));return{origin:[h(n(a,d))+c,l],high:0,low:g(t(a,d))-l,width:i}}else{const l=h(t(a,d));return{origin:[l,g(n(a,d))+c],high:h(e(a,d))-l,low:0,width:i}}},s.xValues=()=>"vertical"===l?[n]:[e,t],s.yValues=()=>"vertical"===l?[e,t]:[n],s.orient=(...e)=>e.length?(l=e[0],s):l,s.lowValue=(...e)=>e.length?(t=we(e[0]),s):t,s.highValue=(...t)=>t.length?(e=we(t[0]),s):e,s.crossValue=(...e)=>e.length?(n=we(e[0]),s):n,s.bandwidth=(...e)=>e.length?(o=we(e[0]),s):o,s.align=(...e)=>e.length?(r=e[0],s):r,s},Pe=()=>{let e,t=e=>e.date,n=e=>e.open,l=e=>e.high,r=e=>e.low,o=e=>e.close,s=()=>5,c="center",h=(a,n)=>e.xScale()(t(a,n));return e=Se({decorate:()=>{},defined:(e,a)=>O(t,n,r,l,o)(e,a),xScale:a.scaleIdentity(),yScale:a.scaleIdentity()}),e.values=(t,a)=>{const i=o(t,a),d=n(t,a),g=s(t,a),m=be(c,g);let u="";return i>d?u="up":i<d&&(u="down"),{cross:h(t,a)+m,open:e.yScale()(d),high:e.yScale()(l(t,a)),low:e.yScale()(r(t,a)),close:e.yScale()(i),width:g,direction:u}},e.xValues=()=>[t],e.yValues=()=>[n,l,r,o],e.crossValue=(...a)=>a.length?(t=a[0],e):t,e.openValue=(...t)=>t.length?(n=t[0],e):n,e.highValue=(...t)=>t.length?(l=t[0],e):l,e.lowValue=(...t)=>t.length?(r=t[0],e):r,e.yValue=e.closeValue=(...t)=>t.length?(o=t[0],e):o,e.bandwidth=(...t)=>t.length?(s=we(t[0]),e):s,e.align=(...t)=>t.length?(c=t[0],e):c,e},Ee=(e,t)=>{const a=Pe(),n=se("g",t),l=e=>"translate("+e.cross+", "+e.high+")",r=e=>t=>e.selection?t.transition(e):t,s=i=>{i.selection&&n.transition(i);const s=r(i);i.each((i,r,d)=>{const c=i.filter(a.defined()),h=n(o.select(d[r]),c);h.enter().attr("transform",(e,t)=>l(a.values(e,t))+" scale(1e-6, 1)").append("path"),h.each((n,r,i)=>{const d=a.values(n,r),c="up"===d.direction?_e.green:_e.red,h=s(o.select(i[r])).attr("class",t+" "+d.direction).attr("stroke",c).attr("fill",c).attr("transform",()=>l(d)+" scale(1)");e.x(0).width(d.width).open(()=>d.open-d.high).high(0).low(()=>d.low-d.high).close(()=>d.close-d.high),h.select("path").attr("d",e([n]))}),a.decorate()(h,i,r)})};return q(s,n,"key"),H(s,a),s},De=e=>{const t=Pe(),a=a=>{const n=a.filter(t.defined()),l=e.context();n.forEach((a,n)=>{l.save();const i=t.values(a,n);l.translate(i.cross,i.high),l.beginPath(),e.x(0).open(()=>i.open-i.high).width(i.width).high(0).low(()=>i.low-i.high).close(()=>i.close-i.high)([a]);const r="up"===i.direction?_e.green:_e.red;l.strokeStyle=r,l.fillStyle=r,t.decorate()(l,a,n),l.fill(),l.stroke(),l.closePath(),l.restore()})};return q(a,e,"context"),H(a,t),a},Ce=()=>{let e=e=>e.upperQuartile,t=e=>e.lowerQuartile,n=e=>e.high,l=e=>e.low,r=e=>e.value,o=e=>e.median,s="vertical",c="center",h=()=>5;const g=Se({decorate:()=>{},defined:(a,s)=>O(l,n,t,e,r,o)(a,s),xScale:a.scaleIdentity(),yScale:a.scaleIdentity()});return g.values=(a,d)=>{const i=h(a,d),m=be(c,i),u=g.xScale(),p=g.yScale();if("vertical"===s){const s=p(n(a,d));return{origin:[u(r(a,d))+m,s],high:0,upperQuartile:p(e(a,d))-s,median:p(o(a,d))-s,lowerQuartile:p(t(a,d))-s,low:p(l(a,d))-s,width:i}}else{const s=u(l(a,d));return{origin:[s,p(r(a,d))+m],high:u(n(a,d))-s,upperQuartile:u(e(a,d))-s,median:u(o(a,d))-s,lowerQuartile:u(t(a,d))-s,low:0,width:i}}},g.xValues=()=>"vertical"===s?[r]:[e,t,n,l,o],g.yValues=()=>"vertical"===s?[e,t,n,l,o]:[r],g.orient=(...e)=>e.length?(s=e[0],g):s,g.lowerQuartileValue=(...e)=>e.length?(t=we(e[0]),g):t,g.upperQuartileValue=(...t)=>t.length?(e=we(t[0]),g):e,g.lowValue=(...e)=>e.length?(l=we(e[0]),g):l,g.highValue=(...e)=>e.length?(n=we(e[0]),g):n,g.crossValue=(...e)=>e.length?(r=we(e[0]),g):r,g.medianValue=(...e)=>e.length?(o=we(e[0]),g):o,g.bandwidth=(...e)=>e.length?(h=we(e[0]),g):h,g.align=(...e)=>e.length?(c=e[0],g):c,g},Le=()=>{let e=[],t=e=>e,n=(e,t)=>t;const i=Se({decorate:()=>{},xScale:a.scaleIdentity(),yScale:a.scaleIdentity()});return i.xValues=()=>e.map(e=>e.xValues()).reduce((e,t)=>e.concat(t)),i.yValues=()=>e.map(e=>e.yValues()).reduce((e,t)=>e.concat(t)),i.mapping=(...e)=>e.length?(t=e[0],i):t,i.key=(...e)=>e.length?(n=e[0],i):n,i.series=(...t)=>t.length?(e=t[0],i):e,i},Oe=()=>{const e=Le(),t=se("g"),a=se("g","multi"),n=n=>{n.selection&&(a.transition(n),t.transition(n));const i=e.mapping(),l=e.series(),r=e.xScale(),s=e.yScale();n.each((n,d,c)=>{const h=a(o.select(c[d]),l);h.each((e,a,d)=>{e.xScale(r).yScale(s);const c=i(n,a,l),h=t(o.select(d[a]),[c]);h.call(e)});const g=h.selection?h.selection():h;g.order(),e.decorate()(h,n,d)})};return H(n,e),q(n,a,"key"),n},Be=()=>{let e=null;const t=Le(),a=a=>{const n=t.mapping(),i=t.series(),l=t.xScale(),r=t.yScale();i.forEach((o,s)=>{const d=n(a,s,i);o.context(e).xScale(l).yScale(r);let h;o.decorate?(h=o.decorate(),o.decorate((e,n,l)=>{t.decorate()(e,a,s),h(e,n,l)})):t.decorate()(e,a,s),o(d),h&&o.decorate(h)})};return a.context=(...t)=>t.length?(e=t[0],a):e,H(a,t),a},Re=()=>{let e=()=>50,n="center";const l=a.scaleBand(),r=Se({decorate:()=>{},xScale:a.scaleLinear(),yScale:a.scaleLinear()});return r.offsetScaleForDatum=(a,r,o)=>{const i=e(r,o),s=be(n,i),d=i/2;return l.domain(t.range(0,a.length)).range([-d+s,d+s])},r.bandwidth=(...t)=>t.length?(e=we(t[0]),r):e,r.align=(...e)=>e.length?(n=e[0],r):n,H(r,l,K({paddingInner:"paddingOuter"})),r};const Me=e=>e.sort(t.ascending).filter((e,t,a)=>-1===a.indexOf(e,t+1));var Qe=()=>{let e=e=>e.x,n=e=>e.y,l=e=>e.color,r=()=>5,o=()=>5,s=a.interpolateViridis;const c=Se({decorate:()=>{},defined:(t,a)=>O(e,n,l)(t,a),xScale:a.scaleIdentity(),yScale:a.scaleIdentity()});return c.pathGenerator=ae().x(0).y(0),c.colorScale=e=>{const n=e.map(l);return a.scaleLinear().domain([t.min(n),t.max(n)])},c.values=(t,a)=>({x:c.xScale()(e(t,a)),y:c.yScale()(n(t,a)),colorValue:l(t,a),width:o(t,a),height:r(t,a)}),c.xValues=()=>[e],c.yValues=()=>[n],c.xValue=(...t)=>t.length?(e=we(t[0]),c):e,c.yValue=(...e)=>e.length?(n=we(e[0]),c):n,c.colorValue=(...e)=>e.length?(l=we(e[0]),c):l,c.colorInterpolate=(...e)=>e.length?(s=e[0],c):s,c.xBandwidth=(...e)=>e.length?(o=we(e[0]),c):o,c.yBandwidth=(...e)=>e.length?(r=we(e[0]),c):r,H(c,c.pathGenerator,K({horizontalAlign:"xAlign",verticalAlign:"yAlign"})),c},Fe=e=>"function"==typeof e?e:()=>e,Ue=()=>{let e=a.scaleIdentity(),t=a.scaleIdentity(),n=e=>e,i=n,l=()=>{},r="horizontal";const s=se("g","annotation-line"),d=a=>{if(a.selection&&s.transition(a),"horizontal"!==r&&"vertical"!==r)throw new Error("Invalid orientation");const d="horizontal"===r,c=d?(e,t)=>`translate(${e}, ${t})`:(e,t)=>`translate(${t}, ${e})`,h=d?"x2":"y2",g=d?e:t,m=d?t:e,u=d?"left-handle":"bottom-handle",p=d?"right-handle":"top-handle",f=d?"9":"0",y=d?"0":"9",x=d?"0.32em":"0.71em",v=d?"start":"middle",w=g.range(),b=(...e)=>c(w[0],m(n(...e))),S=w[1]-w[0];a.each((e,t,a)=>{const n=s(o.select(a[t]),e),d=n.enter().attr("transform",b).style("stroke","#bbb");d.append("line").attr(h,S),d.append("g").classed(u,!0).style("stroke","none"),d.append("g").classed(p,!0).style("stroke","none").attr("transform",c(S,0)).append("text").attr("text-anchor",v).attr("x",f).attr("y",y).attr("dy",x),n.attr("class",`annotation-line ${r}`),n.attr("transform",b),n.select("line").attr(h,S),n.select("g."+p).attr("transform",c(S,0)),n.select("text").text(i),l(n,e,t)})};return d.xScale=(...t)=>t.length?(e=t[0],d):e,d.yScale=(...e)=>e.length?(t=e[0],d):t,d.value=(...e)=>e.length?(n=Fe(e[0]),d):n,d.label=(...e)=>e.length?(i=Fe(e[0]),d):i,d.decorate=(...e)=>e.length?(l=e[0],d):l,d.orient=(...e)=>e.length?(r=e[0],d):r,d},Ge=()=>{let e=a.scaleIdentity(),t=a.scaleIdentity(),n=e=>e,l=n,r=()=>{},o="horizontal";const c=s.line(),h=a=>{if("horizontal"!==o&&"vertical"!==o)throw new Error("Invalid orientation");const s="horizontal"===o,h=c.context(),g=s?e:t,m=s?t:e,u=g.domain(),p=s?9:0,f=s?0:9,v=s?"left":"center",w=s?"middle":"hanging";a.forEach((e,t)=>{h.save(),h.beginPath(),h.strokeStyle="#bbb",h.fillStyle="#000",h.textAlign=v,h.textBaseline=w,r(h,e,t),c.context(h)(u.map(t=>{const a=[g(t),m(n(e))];return s?a:a.reverse()}));const a=s?g(u[1]):m(n(e)),i=s?m(n(e)):g(u[1]);h.fillText(l(e),a+p,i+f),h.fill(),h.stroke(),h.closePath(),h.restore()})};return h.xScale=(...t)=>t.length?(e=t[0],h):e,h.yScale=(...e)=>e.length?(t=e[0],h):t,h.value=(...e)=>e.length?(n=Fe(e[0]),h):n,h.label=(...e)=>e.length?(l=Fe(e[0]),h):l,h.decorate=(...e)=>e.length?(r=e[0],h):r,h.orient=(...e)=>e.length?(o=e[0],h):o,q(h,c,"context"),h},je=()=>{let e=a.scaleIdentity(),t=[10],n=null;const i=()=>null==n?e.ticks?e.ticks(...t):e.domain():n;return i.scale=(...t)=>t.length?(e=t[0],i):e,i.ticks=(...e)=>(t=e,i),i.tickArguments=(...e)=>e.length?(t=e[0],i):t,i.tickValues=(...e)=>e.length?(n=e[0],i):n,i};const qe=e=>e;const Ne=e=>e,He=(e,t,a={})=>{let n=[10],i=null,l=()=>{},r=null,d=6,c=6,h=3;const m=s.line(),u=se("g","tick").key(Ne),p=se("path","domain"),f=()=>({offset:[0,c+h]}),y=()=>({path:[[0,0],[0,c]]}),x=a.labelOffset||f,v=a.tickPath||y,w=(e,t)=>{let a=0;return e.bandwidth&&(a=e.bandwidth()/2,e.round()&&(a=B(a))),n=>t(e(n)+a,0)},b=(e,t)=>k()?`translate(${t}, ${e})`:`translate(${e}, ${t})`,S=e=>k()?e.map(e=>[e[1],e[0]]):e,k=()=>"left"===e||"right"===e,_=(e,a,n)=>t[e]?t[e].apply(t,a):n,T=a=>{a.selection&&(u.transition(a),p.transition(a)),a.each((a,s,c)=>{const h=c[s],f=o.select(h);h.__scale__||f.attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor","right"===e?"start":"left"===e?"end":"middle");const y=h.__scale__||t;h.__scale__=t.copy();const T=null==i?_("ticks",n,t.domain()):i,A=null==r?_("tickFormat",n,Ne):r,z="bottom"===e||"right"===e?1:-1,V=([e,t])=>[e,z*t],I=t.range(),P=S([[I[0],z*d],[I[0],0],[I[1],0],[I[1],z*d]]),E=p(f,[a]);E.attr("d",m(P)).attr("stroke","#000");const D=u(f,T),g=T.map((e,t)=>x(e,t,T)),C=T.map((e,t)=>v(e,t,T));D.enter().attr("transform",w(y,b)).append("path").attr("stroke","#000"),D.enter().append("text").attr("transform",(e,t)=>b(...V(g[t].offset))).attr("fill","#000"),D.exit().attr("transform",w(t,b)),D.select("path").attr("visibility",(e,t)=>C[t].hidden&&"hidden").attr("d",(e,t)=>m(S(C[t].path.map(V)))),D.select("text").attr("visibility",(e,t)=>g[t].hidden&&"hidden").attr("transform",(e,t)=>b(...V(g[t].offset))).attr("dy",()=>{let t="0em";return k()?t="0.32em":"bottom"===e&&(t="0.71em"),t}).text(A),D.attr("transform",w(t,b)),l(D,a,s)})};return T.tickFormat=(...e)=>e.length?(r=e[0],T):r,T.tickSize=(...e)=>e.length?(c=d=+e[0],T):c,T.tickSizeInner=(...e)=>e.length?(c=+e[0],T):c,T.tickSizeOuter=(...e)=>e.length?(d=+e[0],T):d,T.tickPadding=(...e)=>e.length?(h=e[0],T):h,T.decorate=(...e)=>e.length?(l=e[0],T):l,T.scale=(...e)=>e.length?(t=e[0],T):t,T.ticks=(...e)=>(n=[...e],T),T.tickArguments=(...e)=>e.length?(n=null==e[0]?[]:[...e[0]],T):n.slice(),T.tickValues=(...e)=>e.length?(i=null==e[0]?[]:[...e[0]],T):i.slice(),T.orient=()=>e,T},We=(e,t)=>{let a=!1;const n=(e,n,l)=>{let r=0,o=i.tickSizeInner()+i.tickPadding(),s=!1;if(a){const a=t(e),d=n<l.length-1?t(l[n+1]):t.range()[1];r=(d-a)/2,o=i.tickPadding(),s=n===l.length-1&&a===d}return{offset:[r,o],hidden:s}},i=He(e,t,{labelOffset:n}),l=e=>i(e);return l.tickCenterLabel=(...e)=>e.length?(a=e[0],l):a,H(l,i),l},Ye=e=>We("top",e),Xe=e=>We("bottom",e),Ke=e=>We("left",e),Je=e=>We("right",e),Ze=(e,t)=>{let a=null;const n=(e,a,n)=>{if(t.step)return t.step();const i=t(e);return a<n.length-1?t(n[a+1])/i:2*(t.range()[1]-i)},i=(e,t,i)=>{let r=0;return r=a?a(e,t):n(e,t,i)/2,{path:[[r,0],[r,l.tickSizeInner()]],hidden:t===i.length-1}},l=He(e,t,{labelOffset:()=>({offset:[0,l.tickPadding()]}),tickPath:i}),r=e=>{l(e)};return r.tickOffset=(...e)=>e.length?(a=e[0],r):a,H(r,l),r};var $e=e=>{return t=>{const a=e.ticks?e.ticks():e.domain(),n=t.append("text"),i=a.map(e=>n.text(e).node().getBBox()),l=U(...i.map(e=>e.height)),r=U(...i.map(e=>e.width));return n.remove(),{maxHeight:l,maxWidth:r,labelCount:a.length}}};const et="__d3fc-elements__",tt=e=>e[et]||{},at=(e,t)=>void(e[et]=t),nt=e=>delete e[et],it=e=>"D3FC-GROUP"===e.tagName?[e,...e.querySelectorAll("d3fc-canvas, d3fc-group, d3fc-svg")]:[e],lt=e=>{const{width:t,height:a}=tt(e),n=e.useDevicePixelRatio&&null!=global.devicePixelRatio?global.devicePixelRatio:1,i=e.clientWidth*n,l=e.clientHeight*n;at(e,{pixelRatio:n,width:i,height:l,resized:i!==t||l!==a})};if("function"!=typeof CustomEvent)throw new Error("d3fc-element depends on CustomEvent. Make sure that you load a polyfill in older browsers. See README.");const rt=e=>{const t=tt(e),a=new CustomEvent("measure",{detail:t});e.dispatchEvent(a)},ot=e=>{const t=tt(e),a=new CustomEvent("draw",{detail:t});e.dispatchEvent(a)};var st=e=>{const t=e.map(it).reduce((e,t)=>e.concat(t));t.forEach(lt),t.forEach(rt),t.forEach(ot)};const dt=e=>tt(e.ownerDocument).queue||[],ct=(e,t)=>{let{requestId:a}=tt(e.ownerDocument);null==a&&(a=requestAnimationFrame(()=>{const t=dt(e);st(t),ht(e)})),at(e.ownerDocument,{queue:t,requestId:a})},ht=e=>nt(e.ownerDocument),gt=(e,t)=>{let a=e;do if(a.parentNode===t)return!0;while(a=a.parentNode);return!1};var mt=e=>{const t=dt(e),a=-1<t.indexOf(e);if(!a){const a=t.some(t=>gt(e,t));if(!a){const a=t.filter(t=>!gt(t,e));a.push(e),ct(e,a)}}};if("function"!=typeof HTMLElement)throw new Error("d3fc-element depends on Custom Elements (v1). Make sure that you load a polyfill in older browsers. See README.");const ut=e=>{null!=e.__measureListener__||(e.__measureListener__=t=>e.setMeasurements(t.detail),e.addEventListener("measure",e.__measureListener__))},pt=e=>{null==e.__measureListener__||(e.removeEventListener("measure",e.__measureListener__),e.__measureListener__=null)};var ft=(e,t)=>class extends HTMLElement{static get observedAttributes(){return["use-device-pixel-ratio"]}attributeChangedCallback(e){"use-device-pixel-ratio"===e?this.requestRedraw():void 0}connectedCallback(){0===this.childNodes.length&&this.appendChild(e()),ut(this)}disconnectedCallback(){pt(this)}setMeasurements({width:e,height:a}){const{childNodes:[n,...i]}=this;if(0<i.length)throw new Error("A d3fc-svg/canvas element must only contain a single svg/canvas element.");t(n,{width:e,height:a})}get useDevicePixelRatio(){return this.hasAttribute("use-device-pixel-ratio")&&"false"!==this.getAttribute("use-device-pixel-ratio")}set useDevicePixelRatio(e){e&&!this.useDevicePixelRatio?this.setAttribute("use-device-pixel-ratio",""):!e&&this.useDevicePixelRatio&&this.removeAttribute("use-device-pixel-ratio"),this.requestRedraw()}requestRedraw(){mt(this)}},yt=ft(()=>document.createElement("canvas"),(e,{width:t,height:a})=>{e.setAttribute("width",t),e.setAttribute("height",a)});const xt=e=>{e.autoResize?vt(e):wt(e)},vt=e=>{null!=e.__autoResizeListener__||(e.__autoResizeListener__=()=>mt(e),addEventListener("resize",e.__autoResizeListener__))},wt=e=>{null==e.__autoResizeListener__||(removeEventListener("resize",e.__autoResizeListener__),e.__autoResizeListener__=null)};class bt extends HTMLElement{connectedCallback(){xt(this)}disconnectedCallback(){wt(this)}requestRedraw(){mt(this)}get autoResize(){return this.hasAttribute("auto-resize")&&"false"!==this.getAttribute("auto-resize")}set autoResize(e){e&&!this.autoResize?this.setAttribute("auto-resize",""):!e&&this.autoResize&&this.removeAttribute("auto-resize"),xt(this)}static get observedAttributes(){return["auto-resize"]}attributeChangedCallback(e){"auto-resize"===e?xt(this):void 0}}var St=ft(()=>document.createElementNS("http://www.w3.org/2000/svg","svg"),(e,{width:t,height:a})=>{e.setAttribute("viewBox",`0 0 ${t} ${a}`)});const kt=document.createElement("style");if(kt.setAttribute("type","text/css"),document.querySelector("head").appendChild(kt),kt.styleSheet?kt.styleSheet.cssText+="d3fc-canvas,d3fc-svg{position:relative;display:block}d3fc-canvas>canvas,d3fc-svg>svg{position:absolute;height:100%;width:100%}d3fc-svg>svg{overflow:visible}":kt.textContent+="d3fc-canvas,d3fc-svg{position:relative;display:block}d3fc-canvas>canvas,d3fc-svg>svg{position:absolute;height:100%;width:100%}d3fc-svg>svg{overflow:visible}","object"!=typeof customElements||"function"!=typeof customElements.define)throw new Error("d3fc-element depends on Custom Elements (v1). Make sure that you load a polyfill in older browsers. See README.");customElements.define("d3fc-canvas",yt),customElements.define("d3fc-group",bt),customElements.define("d3fc-svg",St);var _t=(...e)=>{const t={},a=e=>{for(const a of Object.keys(t))e[a].apply(null,t[a]);return e};for(const n of e)a[n]=(...e)=>e.length?(t[n]=e,a):t[n];return a};const Tt=document.createElement("style");Tt.setAttribute("type","text/css"),document.querySelector("head").appendChild(Tt),Tt.styleSheet?Tt.styleSheet.cssText+="d3fc-group.cartesian-chart{width:100%;height:100%;overflow:hidden;display:grid;display:-ms-grid;grid-template-columns:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);-ms-grid-columns:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);grid-template-rows:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);-ms-grid-rows:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);}\nd3fc-group.cartesian-chart>.top-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:3;-ms-grid-column:3;grid-row:1;-ms-grid-row:1;}\nd3fc-group.cartesian-chart>.top-axis{height:2em;grid-column:3;-ms-grid-column:3;grid-row:2;-ms-grid-row:2;}\nd3fc-group.cartesian-chart>.left-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:1;-ms-grid-column:1;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.left-axis{width:3em;grid-column:2;-ms-grid-column:2;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.plot-area{overflow:hidden;grid-column:3;-ms-grid-column:3;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.right-axis{width:3em;grid-column:4;-ms-grid-column:4;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.right-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:5;-ms-grid-column:5;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.bottom-axis{height:2em;grid-column:3;-ms-grid-column:3;grid-row:4;-ms-grid-row:4;}\nd3fc-group.cartesian-chart>.bottom-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:3;-ms-grid-column:3;grid-row:5;-ms-grid-row:5;}\nd3fc-group.cartesian-chart>.y-label{display:flex;transform:rotate(-90deg);width:1em;white-space:nowrap;justify-content:center;}":Tt.textContent+="d3fc-group.cartesian-chart{width:100%;height:100%;overflow:hidden;display:grid;display:-ms-grid;grid-template-columns:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);-ms-grid-columns:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);grid-template-rows:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);-ms-grid-rows:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);}\nd3fc-group.cartesian-chart>.top-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:3;-ms-grid-column:3;grid-row:1;-ms-grid-row:1;}\nd3fc-group.cartesian-chart>.top-axis{height:2em;grid-column:3;-ms-grid-column:3;grid-row:2;-ms-grid-row:2;}\nd3fc-group.cartesian-chart>.left-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:1;-ms-grid-column:1;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.left-axis{width:3em;grid-column:2;-ms-grid-column:2;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.plot-area{overflow:hidden;grid-column:3;-ms-grid-column:3;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.right-axis{width:3em;grid-column:4;-ms-grid-column:4;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.right-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:5;-ms-grid-column:5;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.bottom-axis{height:2em;grid-column:3;-ms-grid-column:3;grid-row:4;-ms-grid-row:4;}\nd3fc-group.cartesian-chart>.bottom-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:3;-ms-grid-column:3;grid-row:5;-ms-grid-row:5;}\nd3fc-group.cartesian-chart>.y-label{display:flex;transform:rotate(-90deg);width:1em;white-space:nowrap;justify-content:center;}";const At=e=>"function"==typeof e?e:()=>e;var zt=(...e)=>{const{xScale:t,yScale:a,xAxis:n,yAxis:l}=Vt(...e);let r=At(""),s=At(""),d=At(""),c=At(null),h=At(null),g=At("right"),m=At("bottom"),u=null,p=null,f=_t("tickFormat","ticks","tickArguments","tickSize","tickSizeInner","tickSizeOuter","tickValues","tickPadding","tickCenterLabel"),y=()=>{},x=_t("tickFormat","ticks","tickArguments","tickSize","tickSizeInner","tickSizeOuter","tickValues","tickPadding","tickCenterLabel"),v=()=>{},w=()=>{};const b=se("d3fc-group","cartesian-chart"),S=se("d3fc-canvas","plot-area"),k=se("d3fc-svg","plot-area"),_=se("d3fc-svg","x-axis").key(e=>e),T=se("d3fc-svg","y-axis").key(e=>e),A=se("div","chart-label"),z=se("div","x-label").key(e=>e),V=se("div","y-label").key(e=>e),I=e=>t=>e.selection?t.transition(e):t,P=e=>{const P=I(e);e.each((e,i,I)=>{const E=b(o.select(I[i]),[e]);E.enter().attr("auto-resize",""),A(E,[m(e)]).attr("class",e=>"top"===e?"chart-label bottom-label":"chart-label top-label").style("margin-bottom",e=>"top"===e?0:"1em").style("margin-top",e=>"top"===e?"1em":0).text(r(e)),z(E,[m(e)]).attr("class",e=>`x-label ${e}-label`).text(s(e)),V(E,[g(e)]).attr("class",e=>`y-label ${e}-label`).text(d(e)),S(E,u?[e]:[]).on("draw",(e,n,i)=>{const l=o.select(i[n]).select("canvas").node();u.context(l.getContext("2d")).xScale(t).yScale(a),u(e)}),k(E,p?[e]:[]).on("draw",(e,n,i)=>{p.xScale(t).yScale(a),P(o.select(i[n])).select("svg").call(p)}),_(E,[m(e)]).attr("class",e=>`x-axis ${e}-axis`).style("height",c(e)).on("measure",(e,a,n)=>{const{width:i,height:l}=o.event.detail;"top"===e&&o.select(n[a]).select("svg").attr("viewBox",`0 ${-l} ${i} ${l}`),t.range([0,i])}).on("draw",(e,a,i)=>{const l="top"===e?n.top(t):n.bottom(t);l.decorate(y),P(o.select(i[a])).select("svg").call(f(l))}),T(E,[g(e)]).attr("class",e=>`y-axis ${e}-axis`).style("width",h(e)).on("measure",(e,t,n)=>{const{width:i,height:l}=o.event.detail;"left"===e&&o.select(n[t]).select("svg").attr("viewBox",`${-i} 0 ${i} ${l}`),a.range([l,0])}).on("draw",(e,t,n)=>{const i="left"===e?l.left(a):l.right(a);i.decorate(v),P(o.select(n[t])).select("svg").call(x(i))}),E.each((e,t,a)=>a[t].requestRedraw()),w(E,e,i)})},E=Y(/range\w*/,/tickFormat/);return H(P,t,E,Z("x")),H(P,a,E,Z("y")),H(P,f,Z("x")),H(P,x,Z("y")),P.xOrient=(...e)=>e.length?(m=At(e[0]),P):m,P.yOrient=(...e)=>e.length?(g=At(e[0]),P):g,P.xDecorate=(...e)=>e.length?(y=e[0],P):y,P.yDecorate=(...e)=>e.length?(v=e[0],P):v,P.chartLabel=(...e)=>e.length?(r=At(e[0]),P):r,P.xLabel=(...e)=>e.length?(s=At(e[0]),P):s,P.yLabel=(...e)=>e.length?(d=At(e[0]),P):d,P.xAxisHeight=(...e)=>e.length?(c=At(e[0]),P):c,P.yAxisWidth=(...e)=>e.length?(h=At(e[0]),P):h,P.canvasPlotArea=(...e)=>e.length?(u=e[0],P):u,P.svgPlotArea=(...e)=>e.length?(p=e[0],P):p,P.decorate=(...e)=>e.length?(w=e[0],P):w,P};const Vt=(...e)=>{const t={xScale:a.scaleIdentity(),yScale:a.scaleIdentity(),xAxis:{bottom:Xe,top:Ye},yAxis:{right:Je,left:Ke}};return 1!==e.length||e[0].domain||e[0].range?Object.assign(t,{xScale:e[0]||t.xScale,yScale:e[1]||t.yScale}):Object.assign(t,e[0])},It=e=>"function"==typeof e?e:()=>e;var Pt=(e,t)=>(...a)=>{let n=It(""),i=t,l=()=>{};const r=zt(...a),o=t=>{e(r,i),r.decorate((e,t,a)=>{e.enter().select(".x-label").style("height","1em").style("line-height","1em");const i=r.yOrient()(t);e.enter().append("div").attr("class","y-label-container").style("grid-column","left"===i?1:5).style("-ms-grid-column","left"===i?1:5).style("grid-row",3).style("-ms-grid-row",3).style("width","1em").style("display","flex").style("align-items","center").style("justify-content","center").style("white-space","nowrap").append("div").attr("class","y-label").style("transform","rotate(-90deg)"),e.select(".y-label-container>.y-label").text(n),l(e,t,a)}),t.call(r)};return H(o,r,X(/^x/,/^y/,"chartLabel")),o.yLabel=(...e)=>e.length?(n=It(e[0]),o):n,o.plotArea=(...e)=>e.length?(i=e[0],o):i,o.decorate=(...e)=>e.length?(l=e[0],o):l,o},Et=Pt((e,t)=>e.svgPlotArea(t),Te),Dt=Pt((e,t)=>e.canvasPlotArea(t),Ae);const Ct=e=>"x"===e?c.brushX():"y"===e?c.brushY():"xy"===e?c.brush():void 0,Lt=e=>[e[1],e[0]],Ot=e=>{const t=Ct(e),n=d.dispatch("brush","start","end");let i=a.scaleIdentity(),l=a.scaleIdentity();const r=se("g","brush"),s=(t,a,n)=>"x"===e?t.map(a):"y"===e?t.map(n):"xy"===e?[[a(t[0][0]),n(t[0][1])],[a(t[1][0]),n(t[1][1])]]:void 0,c=e=>s(e,a.scaleLinear().domain(i.range()).invert,a.scaleLinear().domain(Lt(l.range())).invert),h=e=>s(e,a.scaleLinear().domain(i.range()),a.scaleLinear().domain(Lt(l.range()))),g=t=>{const n=a.scaleLinear().domain(i.domain());return"x"===e?t.map(n.invert):"xy"===e?[n.invert(t[0][0]),n.invert(t[1][0])]:void 0},m=t=>{const n=a.scaleLinear().domain(Lt(l.domain()));return"y"===e?[t[1],t[0]].map(n.invert):"xy"===e?[n.invert(t[1][1]),n.invert(t[0][1])]:void 0},u=e=>{if(!(e.sourceEvent&&"draw"===e.sourceEvent.type))if(e.selection){const t=h(e.selection);n.call(e.type,{},{selection:t,xDomain:g(t),yDomain:m(t)})}else n.call(e.type,{},{})},p=e=>{e.each((e,a,n)=>{t.extent([[i.range()[0],l.range()[1]],[i.range()[1],l.range()[0]]]),t.on("end",()=>u(o.event)).on("brush",()=>u(o.event)).on("start",()=>u(o.event));const s=r(o.select(n[a]),[e]);s.call(t).call(t.move,e?c(e):null)})};return p.xScale=(...e)=>e.length?(i=e[0],p):i,p.yScale=(...e)=>e.length?(l=e[0],p):l,q(p,n,"on"),q(p,t,"filter","handleSize"),p};e.annotationCanvasBand=()=>{let e=a.scaleIdentity(),t=a.scaleIdentity(),n="horizontal",l=e=>e.from,r=e=>e.to,o=()=>{};const s=ae().horizontalAlign("right").verticalAlign("top");var d=a=>{if("horizontal"!==n&&"vertical"!==n)throw new Error("Invalid orientation");const c=s.context(),h="horizontal"===n,g=h?e:t,m=h?t:e,u=g.range(),p=u[1]-u[0],f=h?"x":"y",y=h?"y":"x",x=h?"height":"width",v=h?"width":"height";a.forEach((e,t)=>{c.save(),c.beginPath(),c.strokeStyle="transparent",s[y](m(l(e))),s[f](u[0]),s[v](p),s[x](m(r(e))-m(l(e))),o(c,e,t),s.context(c)([e],t),c.fill(),c.stroke(),c.closePath(),c.restore()})};return d.xScale=(...t)=>t.length?(e=t[0],d):e,d.yScale=(...e)=>e.length?(t=e[0],d):t,d.orient=(...e)=>e.length?(n=e[0],d):n,d.decorate=(...e)=>e.length?(o=e[0],d):o,d.fromValue=(...e)=>e.length?(l=Fe(e[0]),d):l,d.toValue=(...e)=>e.length?(r=Fe(e[0]),d):r,q(d,s,"context"),d},e.annotationCanvasCrosshair=()=>{let e=e=>e.x,t=e=>e.y,n=a.scaleIdentity(),i=a.scaleIdentity();const l=Ve(),r=Ge(),o=Ge().orient("vertical"),s=a.scaleIdentity(),c=a.scaleIdentity(),h=Be().series([r,o,l]).xScale(s).yScale(c).mapping(e=>[e]),g=a=>{a.forEach(a=>{s.range(n.range()),c.range(i.range()),l.crossValue(e).mainValue(t),r.value(t),o.value(e),h(a)})};g.x=(...t)=>t.length?(e=t[0],g):e,g.y=(...e)=>e.length?(t=e[0],g):t,g.xScale=(...e)=>e.length?(n=e[0],g):n,g.yScale=(...e)=>e.length?(i=e[0],g):i;const m=X("label","decorate");return H(g,r,m,Z("y")),H(g,o,m,Z("x")),q(g,l,"decorate"),q(g,h,"context"),g},e.annotationCanvasGridline=()=>{let e=()=>{},t=()=>{};const a=je(),n=je(),l=s.line(),r=()=>{const r=l.context(),o=a.scale(),s=n.scale();a().forEach((t,a)=>{r.save(),r.beginPath(),r.strokeStyle="#bbb",r.fillStyle="transparent",e(r,t,a),l.context(r)(s.domain().map(e=>[o(t),s(e)])),r.fill(),r.stroke(),r.closePath(),r.restore()}),n().forEach((e,a)=>{r.save(),r.beginPath(),r.strokeStyle="#bbb",r.fillStyle="transparent",t(r,e,a),l.context(r)(o.domain().map(t=>[o(t),s(e)])),r.fill(),r.stroke(),r.closePath(),r.restore()})};return r.yDecorate=(...e)=>e.length?(t=e[0],r):t,r.xDecorate=(...t)=>t.length?(e=t[0],r):e,H(r,a,Z("x")),H(r,n,Z("y")),q(r,l,"context"),r},e.annotationCanvasLine=Ge,e.annotationSvgBand=()=>{let e=a.scaleIdentity(),t=a.scaleIdentity(),n="horizontal",i=e=>e.from,l=e=>e.to,r=()=>{};const s=se("g","annotation-band"),c=ae().horizontalAlign("center").verticalAlign("center").x(0).y(0);var h=a=>{if(a.selection&&s.transition(a),"horizontal"!==n&&"vertical"!==n)throw new Error("Invalid orientation");const d="horizontal"===n,h=d?(e,t)=>`translate(${e}, ${t})`:(e,t)=>`translate(${t}, ${e})`,g=d?e:t,m=d?t:e,u=g.range(),p=u[1]-u[0],f=d?"height":"width",y=d?"width":"height",x=(...e)=>h((u[1]+u[0])/2,(m(l(...e))+m(i(...e)))/2);c[y](p),c[f]((...e)=>m(l(...e))-m(i(...e))),a.each((e,t,a)=>{var i=s(o.select(a[t]),e);i.enter().attr("transform",x).append("path").classed("band",!0),i.attr("class",`annotation-band ${n}`).attr("transform",x).select("path").attr("d",(e,t)=>c([e],t)),r(i,e,t)})};return h.xScale=(...t)=>t.length?(e=t[0],h):e,h.yScale=(...e)=>e.length?(t=e[0],h):t,h.orient=(...e)=>e.length?(n=e[0],h):n,h.decorate=(...e)=>e.length?(r=e[0],h):r,h.fromValue=(...e)=>e.length?(i=Fe(e[0]),h):i,h.toValue=(...e)=>e.length?(l=Fe(e[0]),h):l,h},e.annotationSvgCrosshair=function(){let e=e=>e.x,t=e=>e.y,n=a.scaleIdentity(),i=a.scaleIdentity(),l=()=>{};const r=se("g","annotation-crosshair"),s=ze(),d=Ue(),c=Ue().orient("vertical"),h=a.scaleIdentity(),m=a.scaleIdentity(),u=Oe().series([d,c,s]).xScale(h).yScale(m).mapping(e=>[e]),p=a=>{a.selection&&r.transition(a),a.each((a,p,f)=>{const y=r(o.select(f[p]),a);y.enter().style("pointer-events","none"),h.range(n.range()),m.range(i.range()),s.crossValue(e).mainValue(t),d.value(t),c.value(e),y.call(u),l(y,a,p)})};p.x=(...t)=>t.length?(e=t[0],p):e,p.y=(...e)=>e.length?(t=e[0],p):t,p.xScale=(...e)=>e.length?(n=e[0],p):n,p.yScale=(...e)=>e.length?(i=e[0],p):i,p.decorate=(...e)=>e.length?(l=e[0],p):l;const f=X("label");return H(p,d,f,Z("y")),H(p,c,f,Z("x")),p},e.annotationSvgGridline=()=>{let e=()=>{},t=()=>{};const a=je(),n=je(),i=se("line","gridline-y").key(qe),l=se("line","gridline-x").key(qe),r=r=>{r.selection&&(i.transition(r),l.transition(r)),r.each((r,s,d)=>{const c=d[s],h=o.select(d[s]),g=a.scale(),m=n.scale(),u=c.__x_scale__||g;c.__x_scale__=g.copy();const p=a(),f=i(h,p);f.enter().attr("x1",u).attr("x2",u).attr("y1",m.range()[0]).attr("y2",m.range()[1]),f.attr("x1",g).attr("x2",g).attr("y1",m.range()[0]).attr("y2",m.range()[1]).attr("stroke","#bbb"),f.exit().attr("x1",g).attr("x2",g),e(f,p,s);const y=c.__y_scale__||m;c.__y_scale__=m.copy();const x=n(),v=l(h,x);v.enter().attr("y1",y).attr("y2",y).attr("x1",g.range()[0]).attr("x2",g.range()[1]),v.attr("y1",m).attr("y2",m).attr("x1",g.range()[0]).attr("x2",g.range()[1]).attr("stroke","#bbb"),v.exit().attr("y1",m).attr("y2",m),t(v,x,s)})};return r.yDecorate=(...e)=>e.length?(t=e[0],r):t,r.xDecorate=(...t)=>t.length?(e=t[0],r):e,H(r,i,K({key:"xKey"})),H(r,l,K({key:"yKey"})),H(r,a,Z("x")),H(r,n,Z("y")),r},e.annotationSvgLine=Ue,e.autoBandwidth=e=>{let a=.75;const n=e=>{if(1>=e.length)return 10;e=Me(e);const n=t.pairs(e).map(e=>G(e[0]-e[1])),i=t.min(n);return a*i},i=(t,a,i)=>{if(t.bandwidth)return t.bandwidth();else{const l=Array.isArray(a)?[].concat(...a):a,r=l.filter(e.defined()).map(i()).map(t),o=n(r);return o}},l=t=>{const a=t=>{if(e.xBandwidth&&e.yBandwidth)e.xBandwidth(i(e.xScale(),t,e.xValue)),e.yBandwidth(i(e.yScale(),t,e.yValue));else{const a=e.orient&&"horizontal"===e.orient()?e.yScale():e.xScale();e.bandwidth(i(a,t,e.crossValue))}};t instanceof o.selection?t.each((t,n,i)=>{a(t),e(o.select(i[n]))}):(a(t),e(t))};return H(l,e),l.widthFraction=(...e)=>e.length?(a=e[0],l):a,l},e.axisBottom=Xe,e.axisLabelOffset=e=>{let t="auto",a=()=>{};const n=()=>"left"===e.orient()||"right"===e.orient(),l=()=>"top"===e.orient()||"left"===e.orient()?-1:1,r=a=>{const{maxHeight:r,maxWidth:o,labelCount:s}=$e(e.scale())(a),d=e.scale().range()[1],c="auto"===t?R((n()?r:o)*s/d)+1:t,h=a.select("text"),g=h.attr("transform"),m=e=>n()?`translate(${e%c*o*l()}, 0)`:`translate(0, ${e%c*r*l()})`;h.attr("transform",(e,t)=>`${g} ${m(t)}`)},o=t=>e(t);return e.decorate(e=>{r(e),a(e)}),o.decorate=(...e)=>e.length?(a=e[0],o):a,o.labelOffsetDepth=(...e)=>e.length?(t=e[0],o):t,H(o,e,Y("decorate")),o},e.axisLabelRotate=e=>{let t="auto",a=()=>{};const n=()=>"left"===e.orient()||"right"===e.orient(),i=()=>"top"===e.orient()||"left"===e.orient()?-1:1,l=()=>{switch(e.orient()){case"top":case"right":return"start";default:return"end";}},r=a=>{const{maxHeight:r,maxWidth:o,labelCount:s}=$e(e.scale())(a),d=s*o;let c;if("auto"===t){const t=e.scale().range()[1];c=t<d?90*M(1,(d/t-.8)/2):0}else c=t;return{rotate:n()?R(i()*(90-c)):R(-c),maxHeight:r,maxWidth:o,anchor:c?l():"middle"}},o=e=>{const{rotate:t,maxHeight:a,anchor:l}=r(e),o=e.select("text"),s=o.attr("transform"),d=i()*R(a/2),c=n()?`translate(${d}, 0)`:`translate(0, ${d})`;o.style("text-anchor",l).attr("transform",`${s} ${c} rotate(${t} 0 0)`)},s=t=>{e(t)};return e.decorate(e=>{o(e),a(e)}),s.decorate=(...e)=>e.length?(a=e[0],s):a,s.labelRotate=(...e)=>e.length?(t=e[0],s):t,H(s,e,Y("decorate")),s},e.axisLeft=Ke,e.axisOrdinalBottom=e=>Ze("bottom",e),e.axisOrdinalLeft=e=>Ze("left",e),e.axisOrdinalRight=e=>Ze("right",e),e.axisOrdinalTop=e=>Ze("top",e),e.axisRight=Je,e.axisTop=Ye,e.brush=()=>Ot("xy"),e.brushX=()=>Ot("x"),e.brushY=()=>Ot("y"),e.bucket=E,e.chartCanvasCartesian=Dt,e.chartCartesian=zt,e.chartSvgCartesian=Et,e.dataJoin=se,e.discontinuityIdentity=S,e.discontinuityRange=(...e)=>{const t=(e,t)=>e>t[0]&&e<t[1],a=(e,t)=>e[0]>=t[0]&&e[1]<=t[1];var n={};n.distance=(t,i)=>{t=n.clampUp(t),i=n.clampDown(i);const l=e.filter(e=>a(e,[t,i])),r=l.map(e=>e[1]-e[0]);return i-t-r.reduce((e,t)=>e+t,0)};const i=(e,t)=>e instanceof Date?new Date(e.getTime()+t):e+t;return n.offset=(t,a)=>{if(0<a){let l=n.clampUp(t),r=a;for(;0<r;){const t=e.filter(e=>e[0]>l).sort((e,t)=>e[0]-t[0]);if(t.length){const e=t[0],a=e[0]-l;a>r?(l=i(l,r),r=0):(l=e[1],r-=a)}else l=i(l,r),r=0}return l}else{let l=n.clampDown(t),r=a;for(;0>r;){const t=e.filter(e=>e[1]<l).sort((e,t)=>t[0]-e[0]);if(t.length){const e=t[0],a=e[1]-l;a<r?(l=i(l,r),r=0):(l=e[0],r-=a)}else l=i(l,r),r=0}return l}},n.clampUp=a=>e.reduce((e,a)=>t(e,a)?a[1]:e,a),n.clampDown=a=>e.reduce((e,a)=>t(e,a)?a[0]:e,a),n.copy=()=>n,n},e.discontinuitySkipUtcWeekends=()=>$(e=>e.getUTCDay(),n.utcDay,n.utcSaturday,n.utcMonday),e.discontinuitySkipWeekends=()=>$(e=>e.getDay(),n.timeDay,n.timeSaturday,n.timeMonday),e.effectivelyZero=oe,e.exclude=Y,e.extentDate=A,e.extentLinear=T,e.extentTime=A,e.feedGdax=P,e.group=()=>{let e="",t="vertical",a=(e,t)=>+e[t];const n=t=>Object.keys(t[0]).filter(t=>t!==e).map(n=>{const i=t.filter(e=>e[n]).map(t=>{const i=[t[e],a(t,n)];return i.data=t,i});return i.key=n,i}),i=t=>t.map(t=>{const n=Object.keys(t).filter(t=>t!==e).map(e=>{const n=[e,a(t,e)];return n.data=t,n});return n.key=t[e],n}),l=e=>"vertical"===t?n(e):i(e);return l.key=(...t)=>t.length?(e=t[0],l):e,l.value=(...e)=>e.length?(a=e[0],l):a,l.orient=(...e)=>e.length?(t=e[0],l):t,l},e.include=X,e.includeMap=K,e.indicatorBollingerBands=f,e.indicatorElderRay=b,e.indicatorEnvelope=w,e.indicatorExponentialMovingAverage=y,e.indicatorForceIndex=function(){let e=e=>e.volume,t=e=>e.close;const a=y().period(13),n=p().period(2).defined(a=>null!=t(a)&&null!=e(a)).accumulator(a=>a&&u((t(a[1])-t(a[0]))*e(a[1]))),i=e=>{const t=n(e);return a(t)};return i.volumeValue=(...t)=>t.length?(e=t[0],i):e,i.closeValue=(...e)=>e.length?(t=e[0],i):t,q(i,a,"period"),i},e.indicatorMacd=x,e.indicatorMovingAverage=v,e.indicatorRelativeStrengthIndex=function(){const e=p().period(14),a=(e,t)=>t+(e[e.length-1]-t)/e.length,n=([e,t])=>e<t?0:e-t,i=([e,t])=>e>t?0:t-e,l=(e,n)=>void 0===n?t.mean(e):a(e,n),r=()=>{let e,a,r;return o=>{if(!o)return void(void 0!==e&&(e=NaN));if(void 0===e)return void(e=o[0]);const s=t.pairs([e,...o]);a=l(s.map(n),a),r=l(s.map(i),r);const d=isNaN(e)?NaN:r/a;return u(100-100/(1+d))}};var o=t=>{const a=r();return e.accumulator(a),e(t)};return q(o,e,"period","value"),o},e.indicatorStochasticOscillator=function(){let e=e=>e.close,a=e=>e.high,n=e=>e.low;const i=p().period(5).defined(t=>null!=e(t)&&null!=a(t)&&null!=n(t)).accumulator(i=>{const l=i&&t.max(i,a),r=i&&t.min(i,n),o=i&&100*(e(i[i.length-1])-r)/(l-r);return u(o)}),l=v().period(3),r=e=>{const t=i(e),a=l(t);return t.map((e,t)=>({k:e,d:a[t]}))};return r.closeValue=(...t)=>t.length?(e=t[0],r):e,r.highValue=(...e)=>e.length?(a=e[0],r):a,r.lowValue=(...e)=>e.length?(n=e[0],r):n,H(r,i,K({period:"kPeriod"})),H(r,l,K({period:"dPeriod"})),r},e.largestTriangleOneBucket=D,e.largestTriangleThreeBucket=C,e.layoutAnnealing=()=>{let e,t=1e3,a=1;const n=e=>{switch(e.location){case"bottom-right":return 0;case"middle-right":case"bottom-center":return e.width*e.height/8;}return e.width*e.height/4},i=t=>e?t.width*t.height-ce(t,e):0,l=(e,t,a)=>he(a,t)+i(e)+n(e),r=e=>{let n=t;const i=(e,t)=>F((t-e)/n)>Math.random();let r=fe().locationScore(l).winningScore(i).rectangles(e);for(;0<n;){const t=xe(e),i=ye(me(e[t]));r=r(i,t),n-=a}return r.rectangles()};return r.temperature=(...e)=>e.length?(t=e[0],r):t,r.cooling=(...e)=>e.length?(a=e[0],r):a,r.bounds=(...t)=>t.length?(e=t[0],r):e,r},e.layoutBoundingBox=()=>{let e=[0,0];const t=t=>t.map(t=>{let a=t.x,n=t.y;return a+t.width>e[0]&&(a-=t.width),n+t.height>e[1]&&(n-=t.height),{height:t.height,width:t.width,x:a,y:n}});return t.bounds=(...a)=>a.length?(e=a[0],t):e,t},e.layoutGreedy=()=>{let e;const t=t=>e?t.width*t.height-ce(t,e):0,a=(e,a,n)=>he(n,a)+t(e),n=e=>{let t=fe().locationScore(a).rectangles(e);return e.forEach((e,a)=>{me(e).forEach(e=>{t=t(e,a)})}),t.rectangles()};return n.bounds=(...t)=>t.length?(e=t[0],n):e,n},e.layoutLabel=e=>{let t=()=>{},n=()=>[0,0],l=e=>[e.x,e.y],r=e||(e=>e),s=()=>{},c=a.scaleIdentity(),h=a.scaleIdentity();const m=se("g","label"),u=e=>{e.each((e,a,i)=>{const d=m(o.select(i[a]),e).call(s),g=d.nodes(),u=g.map((e,t)=>{let a=o.select(e).datum();const i=l(a,t,g);let r=[c(i[0]),h(i[1])],s=n(a,t,g);return{hidden:!1,x:r[0],y:r[1],width:s[0],height:s[1]}}),p=r(u);d.attr("style",(e,t)=>"display:"+(p[t].hidden?"none":"inherit")).attr("transform",(e,t)=>"translate("+p[t].x+", "+p[t].y+")").attr("layout-width",(e,t)=>p[t].width).attr("layout-height",(e,t)=>p[t].height).attr("anchor-x",(e,t)=>u[t].x-p[t].x).attr("anchor-y",(e,t)=>u[t].y-p[t].y),d.call(s),t(d,e,a)})};return H(u,m,X("key")),H(u,r),u.size=(...e)=>e.length?(n=re(e[0]),u):n,u.position=(...e)=>e.length?(l=re(e[0]),u):l,u.component=(...e)=>e.length?(s=e[0],u):s,u.decorate=(...e)=>e.length?(t=e[0],u):t,u.xScale=(...e)=>e.length?(c=e[0],u):c,u.yScale=(...e)=>e.length?(h=e[0],u):h,u},e.layoutRemoveOverlaps=e=>{e=e||(e=>e);const t=t=>{for(t=e(t);;){const e=t.filter(e=>!e.hidden),a=e.map((t,a)=>[t,he(e,a)]),n=ve(a,(e,t)=>t[1]-e[1]);if(0<n[1])n[0].hidden=!0;else break}return t};return H(t,e),t},e.layoutTextLabel=()=>{let e=2,t=e=>e;const a=se("text"),n=se("rect"),i=se("circle"),l=l=>{l.each((l,r,s)=>{const d=s[r],c=o.select(d);let h=+d.getAttribute("layout-width"),g=+d.getAttribute("layout-height"),m=n(c,[l]);m.attr("width",h).attr("height",g);let u=+d.getAttribute("anchor-x"),p=+d.getAttribute("anchor-y"),f=i(c,[l]);f.attr("r",2).attr("cx",u).attr("cy",p);let y=a(c,[l]);y.enter().attr("dy","0.9em").attr("transform",`translate(${e}, ${e})`),y.text(t)})};return l.padding=(...t)=>t.length?(e=t[0],l):e,l.value=(...e)=>e.length?(t=re(e[0]),l):t,l},e.modeMedian=L,e.pointer=()=>{function e(){const e=o.mouse(this);a.call("point",this,[{x:e[0],y:e[1]}])}function t(){void a.call("point",this,[])}const a=d.dispatch("point"),n=a=>{a.on("mouseenter.pointer",e).on("mousemove.pointer",e).on("mouseleave.pointer",t)};return q(n,a,"on"),n},e.prefix=Z,e.randomFinancial=I,e.randomGeometricBrownianMotion=z,e.randomSkipWeekends=function(e){const t=e.date.getDay();return 0!==t&&6!==t},e.rebind=q,e.rebindAll=H,e.scaleDiscontinuous=_,e.seriesCanvasArea=()=>{const e=ke(),t=s.area(),a=a=>{const n=t.context();t.defined(e.defined());const l=a.map(e.values);t.x((e,t)=>l[t].transposedX).y((e,t)=>l[t].transposedY);const r="vertical"===e.orient()?"y":"x";t[r+"0"]((e,t)=>l[t].y0),t[r+"1"]((e,t)=>l[t].y),n.beginPath(),t(a),n.fillStyle=_e.gray,n.strokeStyle="transparent",e.decorate()(n,a),n.fill(),n.stroke(),n.closePath()};return H(a,e,Y("bandwidth","align")),q(a,t,"curve","context"),a},e.seriesCanvasBar=()=>{const e=ke(),t=ae().x(0).y(0),a=t=>"vertical"===e.orient()?t.height:t.width,n=t=>"vertical"===e.orient()?t.width:t.height,i=i=>{const l=t.context(),r=i.filter(e.defined()),o=r.map(e.values);"vertical"===e.orient()?(t.verticalAlign("top"),t.horizontalAlign("center")):(t.horizontalAlign("right"),t.verticalAlign("center")),o.forEach((r,o)=>{l.save(),l.beginPath(),l.translate(r.origin[0],r.origin[1]),a(t)(-r.height),n(t)(r.width),t([r]),l.fillStyle=_e.darkGray,l.strokeStyle="transparent",e.decorate()(l,r.d,o),l.fill(),l.stroke(),l.closePath(),l.restore()})};return H(i,e),q(i,t,"context"),i},e.seriesCanvasBoxPlot=()=>{const e=Ce(),t=ie().value(0),a=a=>{const n=a.filter(e.defined()),l=t.context();t.orient(e.orient()),n.forEach((a,n)=>{l.save();const i=e.values(a,n);l.translate(i.origin[0],i.origin[1]),l.beginPath(),t.median(i.median).upperQuartile(i.upperQuartile).lowerQuartile(i.lowerQuartile).high(i.high).width(i.width).low(i.low)([a]),l.fillStyle=_e.gray,l.strokeStyle=_e.black,e.decorate()(l,a,n),l.fill(),l.stroke(),l.closePath(),l.restore()})};return H(a,e),q(a,t,"cap","context"),a},e.seriesCanvasCandlestick=()=>De(ne()),e.seriesCanvasErrorBar=()=>{const e=Ie(),t=le().value(0),a=a=>{const n=a.filter(e.defined()),l=t.context();t.orient(e.orient()),n.forEach((a,n)=>{l.save();const i=e.values(a,n);l.translate(i.origin[0],i.origin[1]),l.beginPath(),t.high(i.high).width(i.width).low(i.low)([a]),l.strokeStyle=_e.black,l.fillStyle=_e.gray,e.decorate()(l,a,n),l.fill(),l.stroke(),l.closePath(),l.restore()})};return H(a,e),q(a,t,"context"),a},e.seriesCanvasGrouped=function(e){const t=Re(),a=a=>{a.forEach((n,l)=>{const r="horizontal"!==e.orient(),o=(e,n)=>{const i=t.offsetScaleForDatum(a,e,n),o=r?t.xScale():t.yScale();return o(e)+i(l)+i.bandwidth()/2};r?(e.xScale(o),e.yScale(t.yScale())):(e.yScale(o),e.xScale(t.xScale())),e.bandwidth&&e.bandwidth((e,n)=>t.offsetScaleForDatum(a,e,n).bandwidth()),e.decorate((e,a)=>t.decorate()(e,a,l)),e(n)})};return H(a,e,Y("decorate","xScale","yScale")),H(a,t,Y("offsetScaleForDatum")),a},e.seriesCanvasHeatmap=()=>{const e=Qe(),t=t=>{const a=t.filter(e.defined()),n=e.colorInterpolate(),l=e.colorScale(a),r=e.pathGenerator.context();a.forEach((t,a)=>{r.save(),r.beginPath();const i=e.values(t,a);r.translate(i.x,i.y),r.fillStyle=n(l(i.colorValue)),r.strokeStyle="transparent",e.pathGenerator.height(i.height).width(i.width)([t]),e.decorate()(r,t,a),r.fill(),r.stroke(),r.closePath(),r.restore()})};return q(t,e.pathGenerator,"context"),H(t,e),t},e.seriesCanvasLine=Ae,e.seriesCanvasMulti=Be,e.seriesCanvasOhlc=()=>De(te()),e.seriesCanvasPoint=Ve,e.seriesCanvasRepeat=()=>{let e="vertical",t=Ae();const a=Be(),n=n=>{"vertical"===e?a.series(n[0].map(()=>t)).mapping((e,t)=>e.map(e=>e[t])):a.series(n.map(()=>t)).mapping((e,t)=>e[t]),a(n)};return n.series=(...e)=>e.length?(t=e[0],n):t,n.orient=(...t)=>t.length?(e=t[0],n):e,H(n,a,Y("series","mapping")),n},e.seriesSvgArea=()=>{const e=ke(),t=s.area(),a=se("path","area"),n=n=>{n.selection&&a.transition(n),t.defined(e.defined()),n.each((n,i,l)=>{const r=n.map(e.values);t.x((e,t)=>r[t].transposedX).y((e,t)=>r[t].transposedY);const s="vertical"===e.orient()?"y":"x";t[s+"0"]((e,t)=>r[t].y0),t[s+"1"]((e,t)=>r[t].y);const d=a(o.select(l[i]),[n]);d.enter().attr("fill",_e.gray),d.attr("d",t),e.decorate()(d,n,i)})};return H(n,e,Y("bandwidth","align")),q(n,a,"key"),q(n,t,"curve"),n},e.seriesSvgBar=()=>{const e=ae().x(0).y(0),t=ke(),a=se("g","bar"),n=e=>"vertical"===t.orient()?e.height:e.width,l=e=>"vertical"===t.orient()?e.width:e.height,r=e=>"translate("+e[0]+", "+e[1]+")",s=i=>{i.selection&&a.transition(i),i.each((i,s,d)=>{const c=t.orient();if("vertical"!==c&&"horizontal"!==c)throw new Error("The bar series does not support an orientation of "+c);const h=i.filter(t.defined()),m=h.map(t.values);e.width(0).height(0),"vertical"===t.orient()?(e.verticalAlign("top"),e.horizontalAlign("center")):(e.horizontalAlign("right"),e.verticalAlign("center"));const u=a(o.select(d[s]),h);u.enter().attr("transform",(e,t)=>r(m[t].baseOrigin)).attr("class","bar "+t.orient()).attr("fill",_e.darkGray).append("path").attr("d",(t,a)=>(l(e)(m[a].width),e([t]))),u.attr("transform",(e,t)=>r(m[t].origin)).select("path").attr("d",(t,a)=>(l(e)(m[a].width),n(e)(-m[a].height),e([t]))),t.decorate()(u,h,s)})};return H(s,t),q(s,a,"key"),s},e.seriesSvgBoxPlot=()=>{const e=Ce(),t=se("g","box-plot"),a=ie().value(0),n=e=>t=>e.selection?t.transition(e):t,l=e=>"translate("+e.origin[0]+", "+e.origin[1]+")",r=i=>{i.selection&&t.transition(i);const r=n(i);i.each((n,i,s)=>{const d=n.filter(e.defined()),c=t(o.select(s[i]),d);c.enter().attr("stroke",_e.black).attr("fill",_e.gray).attr("transform",(t,a)=>l(e.values(t,a))+" scale(1e-6, 1)").append("path"),a.orient(e.orient()),c.each((t,n,i)=>{const s=e.values(t,n);a.median(s.median).upperQuartile(s.upperQuartile).lowerQuartile(s.lowerQuartile).width(s.width).high(s.high).low(s.low),r(o.select(i[n])).attr("transform",l(s)).select("path").attr("d",a([t]))}),e.decorate()(c,n,i)})};return H(r,e),q(r,t,"key"),q(r,a,"cap"),r},e.seriesSvgCandlestick=()=>Ee(ne(),"candlestick"),e.seriesSvgErrorBar=()=>{const e=Ie(),t=se("g","error-bar"),a=le().value(0),n=e=>t=>e.selection?t.transition(e):t,l=e=>"translate("+e.origin[0]+", "+e.origin[1]+")",r=i=>{i.selection&&t.transition(i);const r=n(i);i.each((n,i,s)=>{const d=n.filter(e.defined()),c=d.map(e.values),h=t(o.select(s[i]),d);h.enter().attr("stroke",_e.black).attr("fill",_e.gray).attr("transform",(t,a)=>l(e.values(t,a))+" scale(1e-6, 1)").append("path"),a.orient(e.orient()),h.each((e,t,n)=>{const i=c[t];a.high(i.high).low(i.low).width(i.width),r(o.select(n[t])).attr("transform",l(i)+" scale(1)").select("path").attr("d",a([e]))}),e.decorate()(h,n,i)})};return H(r,e),q(r,t,"key"),r},e.seriesSvgGrouped=e=>{const t=Re(),a=se("g","grouped"),n=n=>{n.selection&&a.transition(n),n.each((n,i,l)=>{const r=a(o.select(l[i]),n);r.enter().append("g"),r.select("g").each((a,l,r)=>{const s=o.select(r[l]),c="horizontal"!==e.orient(),h=(e,a)=>{const i=t.offsetScaleForDatum(n,e,a),r=c?t.xScale():t.yScale();return r(e)+i(l)+i.bandwidth()/2};c?(e.xScale(h),e.yScale(t.yScale())):(e.yScale(h),e.xScale(t.xScale())),e.bandwidth&&e.bandwidth((e,a)=>t.offsetScaleForDatum(n,e,a).bandwidth()),e.decorate((e,a)=>t.decorate()(e,a,l)),s.call(e)})})};return H(n,e,Y("decorate","xScale","yScale")),H(n,t,Y("offsetScaleForDatum")),n},e.seriesSvgHeatmap=()=>{const e=Qe(),t=se("g","box"),a=e=>"translate("+e.x+", "+e.y+")",n=n=>{n.each((n,i,l)=>{const r=n.filter(e.defined()),s=e.colorValue(),c=e.colorInterpolate(),h=e.colorScale(r),m=t(o.select(l[i]),r);m.enter().append("path").attr("stroke","transparent"),m.attr("transform",(t,n)=>a(e.values(t,n))).select("path").attr("d",(t,a)=>e.pathGenerator.width(e.values(t,a).width).height(e.values(t,a).height)([t])).attr("fill",(e,t)=>c(h(s(e,t)))),e.decorate()(m,n,i)})};return H(n,e),n},e.seriesSvgLine=Te,e.seriesSvgMulti=Oe,e.seriesSvgOhlc=()=>Ee(te(),"ohlc"),e.seriesSvgPoint=ze,e.seriesSvgRepeat=()=>{let e="vertical",t=Te();const a=Oe(),n=n=>n.each((n,i,l)=>{"vertical"===e?a.series(n[0].map(()=>t)).mapping((e,t)=>e.map(e=>e[t])):a.series(n.map(()=>t)).mapping((e,t)=>e[t]),o.select(l[i]).call(a)});return n.series=(...e)=>e.length?(t=e[0],n):t,n.orient=(...t)=>t.length?(e=t[0],n):e,H(n,a,Y("series","mapping")),n},e.shapeBar=ae,e.shapeBoxPlot=ie,e.shapeCandlestick=ne,e.shapeErrorBar=le,e.shapeOhlc=te,Object.defineProperty(e,"__esModule",{value:!0})});
