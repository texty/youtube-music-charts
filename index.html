<!DOCTYPE html>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>YOUTUBE</title>


<!-- Links -->
<link href="https://fonts.googleapis.com/css?family=Open+Sans&display=swap&subset=cyrillic,cyrillic-ext" rel="stylesheet">
<link rel='stylesheet' href="css/styles.css">


<!-- Scripts -->
<script src="//cdn.jsdelivr.net/npm/d3"></script>
<script src="//cdn.jsdelivr.net/npm/d3-dsv"></script>
<script src="//cdn.jsdelivr.net/npm/globe.gl"></script>
<!--<script src="libs/Tween.min.js"></script>-->
<body>
<article>

<div class="text">
    <h1>Українські youtube-чарти</h1>

    <h5 id="credits"><s>Скрейпіла кончений youtube</s> Над проектом  працювала: Євгенія Дроздова</h5>



    <p>Звісно, youtube чарти -  не те місце, де варто шукати хорошої музики, тим не менш ми вирішили подивитись, що там відбувається і виявили дещо цікаве.</p>

    <p>Наприклад, у 2019 році український гурт КАЗКА отримав на youtube понад 347 млн переглядів. Це, звісно, не Billie Eilish, проте найвищий показник серед українських виконавців. На випадок, якщо вам буває сумно від засилля російської попси та репу в українських чартах, зазначимо, що 98 млн переглядів КАЗКА мала з Росії і 83.5 з Україні. Непогано, як для гурту, що співає, здебільшого, українською.</p>

    <p> Мало того, россійський реп-дует HammAli & Navai  записали українською аж пів пісні. На цілу хлопці не наважились, тому поки що виглядає скоріше як натяк, що українська і російська мови можуть чудово уживатись разом. Але ми щиро бажаємо хлопцям повноцінного україномовного альбому, бо росіяни нам здорово винні за російські пісні Лорак, Лободи, Барських, Дорна та інших. </p>

    <p>Але, повернемось до України. Якщо ви пограєтесь з глобусом, то побачите, що рок-гурт The Hardkiss шалено популярний в Індії та Індонезії, так само як Kavabanga Depo Kolibri. А от, наприклад, мексиканцям заходить наша Настя Каменських (NK). Майже 25% всіх фанатів Вінника живуть у Києві, а ще Monatik популярніший за Maruv. </p>

    <p>Ми дослідили, хто з наших музикантів зміг прорватись у вітчизняні youtube чарти скрізь товсту стіну росмузону, та де по світу слухали українську музику.</p>


    <p>На графіках ліворуч частота і позиції виконавця в щотижневих українських youtube чартах "Найкращі виконавці". Виконавці відсотртовані за кількістю просмотрів в українському сегменті youtube. На глобусі - кількість переглядів по окремих містах світу. По кожному виконавцю youtube надає інформацію щодо ТОП-100 міст за кількістю перегдядів. Графіки клікабельні. Глобус можна крутити.</p>
</div>


<div id="globeViz"></div>
<div id="my_dataviz"></div>



</article>
<script type="text/javascript" src="libs/d3.v4.js"></script>
<script src="https://unpkg.com/d3fc/build/d3fc.min.js"></script>
<script type="text/javascript" src="libs/jquery-3.3.1.min.js"></script>
<script src="js/pult.js"></script>

<script>
    var chart_data;
    function retrieve_chart_data(cb) {
        if (chart_data) return cb(chart_data);

        return d3.csv("data/globeDate.csv", function(err, myData){
            if (err) throw err;

            myData.forEach(function (item) {
                item.lat = +item.lat;
                item.lng = +item.lng;
                item.views = +item.views ;
            });

            chart_data = myData;
            if (cb) return cb(myData);
            return;
        })
    }



//    fetch('data/world_population2.csv').then(res => res.text())
//    .then(csv => d3.csvParse(csv, ({ lat, lng, pop }) => ({ lat: +lat, lng: +lng, pop: +pop })))
//    .then(data => world.hexBinPointsData(data));


    retrieve_chart_data(function(myData) {

        const wrapper = document.getElementById('globeViz').getBoundingClientRect();
        const globeWidth = wrapper.width;

        const MAP_CENTER = { lat: 46, lng: 32, altitude: 3.0 };

        const weightColor = d3.scaleSequentialSqrt(d3.interpolateYlOrRd)
                .domain([0, 1e7]);




        const world = Globe( {  })
        (document.getElementById('globeViz'))
                .globeImageUrl('//cdn.jsdelivr.net/npm/three-globe/example/img/earth-night.jpg')
                .bumpImageUrl('//cdn.jsdelivr.net/npm/three-globe/example/img/earth-topology.png')
                .hexBinPointWeight('views')
                .hexAltitude(function(d){ return  d.sumWeight * 6e-7 })
                .width(globeWidth)
                .height(wrapper.height)
                .hexBinResolution(4)
                .hexTopColor(function(d){ return weightColor(d.sumWeight)})
                .hexSideColor(function(d){ return weightColor(d.sumWeight)})
                .hexBinMerge(false)
                .hexTransitionDuration(500)
                .enablePointerInteraction(false)
                .pointOfView(MAP_CENTER);


        // Add auto-rotation
        world.controls().autoRotate = false;
        $("#my_dataviz").css("margin-top", "-100vh");
        //world.controls().autoRotateSpeed = 0.1;


        $(".artist-chart").on("click", function () {
            var artist = $(this).attr("data");
            var color = $(this).attr("color").replace(')', ', 0.5)').replace('rgb', 'rgba');
            console.log(color);
            $(".artist-name").css("background-color", "transparent");
            $(this).find(".artist-name").css("background-color", color);



            var artistData = myData.filter(function(d){
                return d.artist === artist
            });

            world.hexBinPointsData(artistData)

        });



    });


</script>
</body>
