<!DOCTYPE html>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>YOUTUBE</title>


<!-- Links -->
<link href="https://fonts.googleapis.com/css?family=Nunito:300i,400,400i,600,600i,700&display=swap&subset=cyrillic" rel="stylesheet">
<link rel='stylesheet' href="css/styles.css">


<!-- Scripts -->
<script src="//cdn.jsdelivr.net/npm/d3"></script>
<script src="//cdn.jsdelivr.net/npm/d3-dsv"></script>
<script src="//cdn.jsdelivr.net/npm/globe.gl"></script>
<script src="libs/Tween.min.js"></script>
<body>

<div id="globeViz" style="width: 40%; position: sticky; top:0; left: 50%;"></div>
<div id="my_dataviz" style="width: 60%; margin-top: -100vh;"></div>




<script type="text/javascript" src="libs/d3.v4.js"></script>
<script src="https://unpkg.com/d3fc/build/d3fc.min.js"></script>
<script type="text/javascript" src="libs/jquery-3.3.1.min.js"></script>
<script src="js/pult.js"></script>

<script>
    const wrapper = document.getElementById('globeViz').getBoundingClientRect();
    var globeWidth = wrapper.width;
    const weightColor = d3.scaleSequentialSqrt(d3.interpolateYlOrRd)
            .domain([0, 1e7]);

    const world = Globe( {  })
            (document.getElementById('globeViz'))
            .globeImageUrl('//cdn.jsdelivr.net/npm/three-globe/example/img/earth-night.jpg')
            .bumpImageUrl('//cdn.jsdelivr.net/npm/three-globe/example/img/earth-topology.png')
            .hexBinPointWeight('pop')
            .hexAltitude(function(d){ return  d.sumWeight * 6e-8 })
            .width([globeWidth])
            .hexBinResolution(4)
            .hexTopColor(function(d){ return weightColor(d.sumWeight)})
            .hexSideColor(function(d){ return weightColor(d.sumWeight)})
            .hexBinMerge(false)
            .enablePointerInteraction(false); // performance improvement


    // Add auto-rotation
    world.controls().autoRotate = true;
    world.controls().autoRotateSpeed = 0.1;

    setTimeout(function(){

        document.getElementById("MARUV").addEventListener("click", function() {
            fetch('data/world_population.csv').then(res => res.text())
            .then(csv => d3.csvParse(csv, ({ lat, lng, pop }) => ({ lat: +lat, lng: +lng, pop: +pop })))
            .then(data => world.hexBinPointsData(data));
        });

        document.getElementById("DZIDZIO").addEventListener("click", function() {

            d3.csv("data/world_population2.csv", function(newdata) {

                newdata.forEach(function(d){
                    d.lat = +d.lat;
                    d.lon = +d.lon;
                    d.pop = +d.pop;
                });


                world.hexBinPointsData(newdata);

            })

        });


    }, 100);

//    $("#DZIDZIO").on("click", function() {
//        fetch('data/world_population2.csv').then(res => res.text())
//        .then(csv => d3.csvParse(csv, ({ lat, lng, pop }) => ({ lat: +lat, lng: +lng, pop: +pop })))
//        .then(data => world.hexBinPointsData(data));
//    });


</script>
</body>
