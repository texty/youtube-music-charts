<!DOCTYPE html>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>YOUTUBE</title>


<!-- Links -->
<link href="https://fonts.googleapis.com/css?family=Open+Sans|Roboto:300,400,400i,500,500i,700|Ubuntu:400,400i,500,500i,700&display=swap&subset=cyrillic,cyrillic-ext" rel="stylesheet">
<link rel='stylesheet' href="css/styles.css">


<!-- Scripts -->
<script src="//cdn.jsdelivr.net/npm/d3"></script>
<script src="//cdn.jsdelivr.net/npm/d3-dsv"></script>
<script src="//cdn.jsdelivr.net/npm/globe.gl"></script>
<!--<script src="libs/Tween.min.js"></script>-->
<body>

<div class="text">
    <h1>Український youtube-charts</h1>


    <p>Звісно, youtube чарти -  не те місце, де варто шукати хорошої музики, тим не менш ми вирішили подивитись на цьогорічні чарти і виявили дещо цікаве.</p>


    <p>Наприклад, у 2019 році український гурт КАЗКА отримав на youtube понад 347 млн переглядів. Це, звісно, менше ніж в Billie Eilish, проте найвищий показник серед українських виконавців. На випадок, якщо вам буває сумно від засилля російської попси та репу в українських чартах, зазначимо, що  98 млн переглядів КАЗКА мала з Росії і 83.5 з Україні. Непогано, як для гурту, що співає українською.</p>

    <p>А от наприклад, рок-гурт The Hardkiss популярний в Індії та Індонезії,  в той час як мексиканцям захожить наша Настя Каменських (NK)</p>

    <p>Ми дослідили, хто з українських виконавців зміг прорватись скрізь товсту стіну російської музики в українські youtube чарти, та де, крім України, слухали нашу музику.
    </p>

    <p style="font-size:15px; font-weight: 400; text-align: right; margin: 50px 0 80px 0;" ><s>Скрейпіла кончений youtube</s> Над проектом  працювала: Євгенія Дроздова</p>

    <p>На графіках ліворуч частота і позиції виконавця в щотижневих українських youtube чартах "Найкращі виконавці". Виконавці відсотртовані за кількістю просмотрів в українському сегменті youtube. На глобусі - кількість переглядів по окремих містах світу. По кожному виконавцю youtube надає інформацію щодо ТОП-100 міст за кількістю перегдядів.</p>






</div>
<div id="loading"></div>
<div id="globeViz" style="width: 40%; position: sticky; top:0; left: 50%;">


</div>
<div id="my_dataviz" style="width: 60%;"></div>




<script type="text/javascript" src="libs/d3.v4.js"></script>
<script src="https://unpkg.com/d3fc/build/d3fc.min.js"></script>
<script type="text/javascript" src="libs/jquery-3.3.1.min.js"></script>
<script src="js/pult.js"></script>

<script>
    var chart_data;
    function retrieve_chart_data(cb) {
        if (chart_data) return cb(chart_data);

        return d3.csv("data/globeDate.csv", function(err, myData){
            if (err) throw err;

            myData.forEach(function (item) {
                item.lat = +item.lat;
                item.lng = +item.lng;
                item.views = +item.views ;
            });

            chart_data = myData;
            if (cb) return cb(myData);
            return;
        })
    }



//    fetch('data/world_population2.csv').then(res => res.text())
//    .then(csv => d3.csvParse(csv, ({ lat, lng, pop }) => ({ lat: +lat, lng: +lng, pop: +pop })))
//    .then(data => world.hexBinPointsData(data));


    retrieve_chart_data(function(myData) {

        const wrapper = document.getElementById('globeViz').getBoundingClientRect();
        var globeWidth = wrapper.width;
        const MAP_CENTER = { lat: 46, lng: 32, altitude: 2.5 };

        const weightColor = d3.scaleSequentialSqrt(d3.interpolateYlOrRd)
                .domain([0, 1e7]);




        const world = Globe( {  })
        (document.getElementById('globeViz'))
                .globeImageUrl('//cdn.jsdelivr.net/npm/three-globe/example/img/earth-night.jpg')
                .bumpImageUrl('//cdn.jsdelivr.net/npm/three-globe/example/img/earth-topology.png')
                .hexBinPointWeight('views')
                .hexAltitude(function(d){ return  d.sumWeight * 6e-7 })
                .width(globeWidth)
                .hexBinResolution(4)
                .hexTopColor(function(d){ return weightColor(d.sumWeight)})
                .hexSideColor(function(d){ return weightColor(d.sumWeight)})
                .hexBinMerge(false)
                .hexTransitionDuration(500)
                .enablePointerInteraction(false)
                .pointOfView(MAP_CENTER);


        // Add auto-rotation
        world.controls().autoRotate = false;
        $("#my_dataviz").css("margin-top", "-100vh");
        //world.controls().autoRotateSpeed = 0.1;

//        var artistData = myData.filter(function(d){
//            return d.artist === "MARUV"
//        });
//
//        world.hexBinPointsData(artistData);


        $(".artist-chart").on("click", function () {
            var artist = $(this).attr("data");


            var artistData = myData.filter(function(d){
                return d.artist === artist
            });

            world.hexBinPointsData(artistData)

        });



    });



//        document.getElementById("MARUV").addEventListener("mouseover", function() {
//        fetch('data/world_population2.csv').then(res => res.text())
//            .then(csv => d3.csvParse(csv, ({ lat, lng, pop }) => ({ lat: +lat, lng: +lng, pop: +pop })))
//            .then(data => world.hexBinPointsData(data));
//        });
//
//
//        document.getElementById("DZIDZIO").addEventListener("mouseover", function() {
//            fetch('data/world_population.csv').then(res => res.text())
//            .then(csv => d3.csvParse(csv, ({ lat, lng, pop }) => ({ lat: +lat, lng: +lng, pop: +pop })))
//            .then(newdata => world.hexBinPointsData(newdata));
//        });
//
//        document.getElementById("Алина Гросу").addEventListener("mouseover", function() {
//            fetch('data/grosu.csv').then(res => res.text())
//            .then(csv => d3.csvParse(csv, ({ lat, lng, views }) => ({ lat: +lat, lng: +lng, pop: +views })))
//            .then(newdata => world.hexBinPointsData(newdata));
//        });





//    }, 500);




</script>
</body>
